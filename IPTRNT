0010 REM  "IPTRNT - 11/04/91 - TRANSFER DATA ENTRY (7512)"
<<<<<<< HEAD
0020 REM LET P= OSCAR; Last rev:
=======
0020 REM Last rev:
0025 IF WHERETO=5 THEN GOTO 2999; REM COMING BACK FROM CREATING PDF FILES
>>>>>>> parent of 33bfc20... 0025 was erase
0030 IF GUI AND LEN(VISITED$)=0 THEN GOSUB SET_VISITED
0040 IF QP_RCD$<>"" THEN LET VISITED_ONE=0
0050 LET TITLE$=" Transportation Entry (7512) "; IF VISITED_ONE THEN GOTO 0060 ELSE GOSUB PROMPTS
0060 LET GOBACK$="IPTRNT"
0070 ON WHERETO GOTO 0100,1000,2395
0100 REM 100,2 ************** OPEN FILES ********************************
0102 LET F0=29,F$="IPTCK"+STBL("CID"); GOSUB GENOPEN; REM TRUCKERS
0104 LET F0=40,F$="RMTB"; GOSUB GENOPEN; REM RM TABLES
0106 LET F0=45,F$="IPCU"+STBL("CID"); GOSUB GENOPEN
0108 LET F0=2,F$="IPTR1"+STBL("CID"); GOSUB GENOPEN; REM 7512 HEADER
0110 LET F0=3,F$="IPTR2"+STBL("CID"); GOSUB GENOPEN; REM 7512 DETAIL
0112 LET F0=64,F$="IPCNT1"; GOSUB GENOPEN
0114 LET F0=65,F$="IPCNT2"; GOSUB GENOPEN; REM US PORTS
0116 LET F0=66,F$="IPCNT3"; GOSUB GENOPEN; REM FOREIGN PORT
0118 LET F0=50,F$="ARCU"+STBL("CID"); GOSUB GENOPEN; REM CUSTOMER
0120 LET F0=9,F$="IPNUM"+STBL("CID"); GOSUB GENOPEN; REM NUMBERING RANGE
0122 LET F0=13,F$="IPLG"+STBL("CID"); GOSUB GENOPEN; REM LOG BOOK
0124 LET FILE[42]=UNT,F$="IPLCG"+STBL("CID"); OPEN (FILE[42],ERR=0126)F$; GOTO 0128
0126 LET F0=42,F$="IPLCG"; GOSUB GENOPEN; REM LOCATION OF GOODS
0128 LET FILE[43]=UNT,F$="IPCR"+STBL("CID"); OPEN (FILE[43],ERR=0130)F$; GOTO 0132
0130 LET F0=43,F$="IPCR"; GOSUB GENOPEN; REM CARRIER
0132 LET F0=46,F$="IPTB"; GOSUB GENOPEN
0134 LET F0=10,F$="IPAWB"+STBL("CID"); GOSUB GENOPEN; REM BL/AWB FILE
0136 LET F0=6,F$="IPDFL"+STBL("CID"); GOSUB GENOPEN; REM IMM. DEL. FILE
0140 LET F0=71,F$="RMOPCD"; GOSUB GENOPEN; REM OPERATOR
0150 LET F0=91,F$="AMIBTYPE"; GOSUB GENOPEN; REM CLASS TYPE
0200 REM 200,2 ***************** VARIABLE INITIALIZATION **********************
0201 LET FORCE_OPERATOR=0,FORCE_OPERATOR=NUM(O2$(28,1),ERR=0202)
0202 LET M0$="000000",M1$="00",M2$="#0.000%",M3$="#######",M4$="#######",M5$="#######.00",MD$="  /  /    ",M6$="#####",M8$="##0.00",M9$="#####0",M12$="#0.000",M13$="########",M14$="#########",M15$="#########.00",M40$="####"
0204 LET M16$="##########",M17$="###########",M18$="###########.00"
0205 CALL "GENARCD.PUB",STBL("CID"),"WS",ASCI_LINK,OSGUI$
0206 CALL "GENCOINF.PUB",0,U0$,U1$,U$
0207 CALL "GENCOSP.PUB",21,IND_UNFORM
0208 DEF FNE(D$)=LEN(D$)=0 OR D$=FILL(LEN(D$))
0210 READ (FILE[40],KEY="MENU"+FILL(4),DOM=0216)IOL=XXTB
0212 LET DO_ENTRY$=CVS(T3$(133,12),2)
0214 IF FNE(DO_ENTRY$) THEN LET DO_ENTRY$="IPDLV"
0224 READ (FILE[40],KEY="IETBL"+STBL("CID")+FILL(3-LEN(STBL("CID"))))IOL=XXTB
0226 LET DIV$=T3$(63,1),JAF_AWB$=T3$(89,1),QP_OPT$=T3$(70,1)
0228 LET NO_NEW_O$=T3$(66,1),DO_AUTO$=T3$(67,1),BILLING_AUTO$=T3$(68,1)
0232 LET CHL_NUMBER$="",ENTERED_IMPORTED$="E",DEF_CONSIGNEE$="Y",DEF_PIECES_WEIGHT$="N",IN_BOND_VIA$="C",VESSEL_FTZ$="N",SP_CUST$=""
0234 READ (FILE[46],KEY="7512O"+STBL("CID")+FILL(3-LEN(STBL("CID"))),DOM=0236)IOL=XXTB; GOTO 0238
0236 READ (FILE[46],KEY="7512OPT ",DOM=0244)IOL=XXTB
0238 LET CHL_NUMBER$=CVS(T3$(13,12),2),ENTERED_IMPORTED$=T3$(37,1),DEF_CONSIGNEE$=T3$(61,1),DEF_PIECES_WEIGHT$=T3$(85,1),IN_BOND_VIA$=T3$(157,1),VESSEL_FTZ$=T3$(181,1),SP_CUST$=T3$(182,6)
0240 DIM CUST_IRS$(12),CUST_NAME$(32),CUST_ADD$(90); READ (FILE[50],KEY=SP_CUST$,DOM=0244)*,CUST_NAME$,CUST_ADD$
0242 DIM CUST_IRS$(12); READ (FILE[45],KEY=SP_CUST$,DOM=0244)*,CUST_IRS$
0244 DIM N0$(4),GOODS_AT$(4),CL_PASS$(6)
0246 READ (FILE[9],KEY="TRAN",DOM=0250)IOL=IPNUM
0252 REM LET OPERATOR_CODES$=""; READ (FILE[40],KEY="OPERAT"+FILL(2),DOM=0257)*,*,*,*,OPERATOR_CODES$
0254 REM LET OPERATOR_CODES$=CVS(OPERATOR_CODES$,2)
0255 REM IF LEN(OPERATOR_CODES$)<24 THEN LET OPERATOR_CODES$=OPERATOR_CODES$+FILL(24-LEN(OPERATOR_CODES$))
0257 READ (FILE[40],KEY="PASS"+STBL("CID")+FILL(4-LEN(STBL("CID"))),DOM=0260)IOL=XXTB
0258 LET AR_PASS$=T3$(1,6),CL_PASS$=T3$(13,6)
0260 IF QP_OPT$<>"Y" THEN CLOSE (FILE[40]); LET FILE[40]=0
0270 CALL "GENCOSP.PUB",9,OK
0280 IF OK=1 THEN LET PRE_ALERT=1 ELSE LET PRE_ALERT=0
0300 REM 300 ****************** DEFINE FUNCTIONS ************************
0310 DEF FND$(D)=DATE(D:STBL("DATEMASK"))
0315 DEF FNE(D$)=LEN(D$)=0 OR D$=FILL(LEN(D$))
0320 REM - 900 (FIL) *********************************************************
0325 IPDFLX: IOLIST I0$,*,*,I3$
0330 ARCUX: IOLIST C0$,C1$,C2$,C3$,C4$,C5$,C1[ALL],C2[ALL],C3,C4,C5[ALL],C6$
0340 IPAWBX: IOLIST AB0$,AB1$
0350 XXTB: IOLIST T0$,T1,T1$,T2$,T3$
0360 IPCNT1: IOLIST R10$,R11$,R12$,R13[ALL],R14[ALL]
0370 IPCNT2: IOLIST R20$,R21$,R22$
0380 IPCNT3: IOLIST R30$,R31$,R32
0390 IPNUM: IOLIST N0$,N$,N1,N2,N3
0400 IPTR1X: IOLIST T0$,T1$,T2$,T3$,T4$,T5$,T6$,T7$
0410 IPTR2X: IOLIST D1$,D2$,D3$,D4[ALL]
0415 IPTR2X_ALT: IOLIST ALT_D1$,ALT_D2$,ALT_D3$,ALT_D4[ALL]
0420 IPLGX: IOLIST L0$,L1$,L2$,L1[ALL],L2[ALL],L3[ALL],L4[ALL],L5[ALL]
0425 IPLGX_ALT: IOLIST LL0$,LL1$,LL2$,LL1[ALL],LL2[ALL],LL3[ALL],LL4[ALL],LL5[ALL]
0430 IPLCG: IOLIST LC0$,LC1$
0440 IPCR: IOLIST CY0$,CY1$
0450 IPTCKX: IOLIST TC0$,TC1$,TC2,TC3[ALL],TC4[ALL],TC5$,TC6$
0460 RMOPCD: IOLIST OP0$,OP1$,OP2$
0470 AMIBTYPE: IOLIST TYPE_CODE$,TYPE_DESC$
1000 REM 1000,5 ****************** MAIN LOGIC *********************************
1001 IF GUI THEN PRINT (OSGUI.CHAN)'CLRTITLE'(4008)
1005 GOSUB CLEAR_GLOBAL; GOSUB DISABLE_FIELDS
1010 IF VESSEL_FTZ$="Y" THEN IF GUI=0 THEN PRINT 'SB',@(46,5),"CASR",@(17,17),"Drayed by"
1015 IF NO_NEW_O$="Y" THEN LET YDISABLE$="D"
1020 DIM T0$(6),T1$(9),T2$(73),T3$(194),T4$(160),T5$(176),T6$(55),T7$(60),A0[14],A1[3],C0$(6),C1$(32),C2$(154),C3$(20),C4$(11),C5$(3),C1[6],C2[6],C5[3],C6$(111),CY0$(4),CY1$(100),TC3[1,4],TC4[1,4],R22$(150)
1022 DIM I3$(240),TYPE_CODE$(2),TYPE_DESC$(25)
1025 DIM AB0$(10),AB1$(30),CUST$(6),LINK_BY$(1)
1028 DIM ALT_D1$(8),ALT_D2$(12),ALT_D3$(25),ALT_D4[3]
1030 DIM D1$(8),D2$(12),D3$(25),D4[3],R13[4,1],R14[0,1],R12$(50)
1035 DIM L0$(6),L1$(150),L2$(170),L1[1],L2[9],L3[7],L4[7],L5[6]
1038 DIM LL0$(6),LL1$(150),LL2$(170),LL1[1],LL2[9],LL3[7],LL4[7],LL5[6]
1040 LET BALANCE$=""
1045 LET SCREEN=1,M=0,WRITELOG=0,P0CHK=0,NEW=1,Y$="",QP=0
1050 IF PREALERT_REF$<>"" THEN LET T0$=PREALERT_REF$; IF GUI=0 THEN PRINT 'SF',@(8,1),T0$,'SB', ELSE PRINT (OSGUI.CHAN)'TITLE'(4000,T0$) FI; GOTO 1110
1052 IF QP_RCD$="" THEN GOTO 1055
1053 LET T0$=QP_RCD$; IF SCREEN=1 THEN LET QP_RCD$=""; GOSUB PROMPTS; GOTO 1107 ELSE IF SCREEN=2 THEN GOTO 2395
1055 GOSUB DATA; GOSUB CLEAR_GLOBAL
1060 DIM W8$(6),W9$(6)
1065 LET X0=1,X1=8,X3=3,X4=6,X$=T0$,WINDID$="IP7512RF",GUI_ID=4000
1070 GOSUB GENINPUT; LET WINDID$=""; REM  "REF. #"
1075 IF Y$="U" THEN GOTO 1020
1080 IF X$="NEW" THEN GOSUB 3760
1085 LET T0$(1,6)=STR(NUM(X$,ERR=1100):M0$)
1090 IF GUI THEN PRINT (OSGUI.CHAN)'TITLE'(4000,T0$) ELSE PRINT 'SF',@(X1,X0),T0$
1095 GOTO 1105
1100 LET O7=6; GOSUB GENERROR; GOTO 1065
1105 IF T0$=M0$ THEN LET O7=1; GOSUB GENERROR; GOTO 1065
1107 READ (FILE[6],KNUM=0,KEY=T0$,DOM=1110)IOL=IPDFLX
1108 LET SAV_GONUM$=I3$(229,12)
1110 READ (FILE[2],KEY=T0$,DOM=1135)IOL=IPTR1X
1111 READ (FILE[91],KNUM=0,KEY=T2$(9,2),DOM=1115)IOL=AMIBTYPE
1115 LET NEW=0
1120 READ (FILE[13],KEY=T0$,DOM=1130)IOL=IPLGX
1122 IF L1$(13,2)="21" OR L1$(13,2)="22" THEN LET X9$="<< Warehouse Entry Reference Type 21/22 was created in Log >>"; GOSUB GENERROR; GOSUB CLEAR_GLOBAL
1125 LET CUST$=L2$(53,6)
1130 GOTO 1138
1135 GOSUB 3295; REM NEW
1138 IF T5$(164,12)=FILL(12) THEN LET T5$(164,12)=SAV_GONUM$
1139 GOSUB DATA; GOSUB CLEAR_GLOBAL; GOSUB ENABLE_FIELDS
1140 IF GUI THEN PRINT (OSGUI.CHAN)'SHOW'(1008,4008,14008),'ENABLE'(4008,14008); GOSUB CLEAR_GLOBAL
1141 LET X0=3,X1=11,X3=0,X4=6,X$=L2$(53,6),WINDID$="IPLOG W1",GUI_ID=4008,PROGID$="IPACI"
1142 GOSUB GENINPUT; REM "CUSTOMER CODE"
1143 IF Y$="U" THEN GOTO 1141
1144 LET L2$(53,6)=X$+FILL(6-LEN(X$))
1145 READ (FILE[50],KEY=L2$(53,6),DOM=1148)
1146 IF GUI THEN LET OSGUI_IPTRNT$=OSGUI$ FI; CALL "GENCKCR.PUB",ERR=1147,L2$(53,6),CRED_ERR,CRED_ERR2,FILE[50],CL_PASS$,GUI,OSGUI_GENCKCR$; IF GUI THEN LET OSGUI$=OSGUI_IPTRNT$; GOSUB RESET_WINDOW
1147 IF CRED_ERR OR CRED_ERR2 THEN GOTO 1000 ELSE GOTO 1149
1148 LET X9$="<< Customer is not on file >>"; GOSUB GENERROR; GOSUB CLEAR_GLOBAL; GOTO 1140
1149 LET X0=1,X1=20,X3=0,X4=8,X$=T2$(11,8),P0CHK=1,GUI_ID=4010
1150 GOSUB GENINPUT; REM  "ENTRY 1"
1155 IF Y$="U" THEN GOTO 1140
1157 LET X$=X$+FILL(X4-LEN(X$))
1160 LET LAST_X$=T2$(11,8),T2$(11,8)=X$
1162 IF GUI AND LAST_X$<>X$ THEN GOSUB CLEAR_GLOBAL
1165 IF T2$(11,8)=FILL(8) THEN LET T2$(19,34)=FILL(34); IF GUI THEN PRINT (OSGUI.CHAN)'CLRTITLE'(4015,4020,4025),'DISABLE'(4015,4020,4025) ELSE PRINT @(37,1),T2$(19,13),@(25,2),T2$(32,13),@(25,3),FILL(10) FI; GOTO 1260
1170 IF GUI THEN PRINT (OSGUI.CHAN)'ENABLE'(4015,4020,4025)
1175 LET X0=1,X1=37,X3=0,X4=13,X$=T2$(19,13),GUI_ID=4015
1180 GOSUB GENINPUT; REM  "ENTRY #"
1185 IF Y$="U" THEN GOTO 1148
1190 LET T2$(19,13)=X$
1195 LET X0=2,X1=25,X3=0,X4=13,X$=T2$(32,13),WINDID$="IPTRNTW3",GUI_ID=4020
1200 GOSUB GENINPUT; LET WINDID$=""; REM  "PORT"
1205 IF Y$="U" THEN GOTO 1175
1210 IF LEN(X$)=4 THEN READ (FILE[65],KEY=X$,DOM=1215,KNUM=0)IOL=IPCNT2; LET X$=R22$(1,16); IF GUI THEN PRINT (OSGUI.CHAN)'TITLE'(4020,X$(1,13)) ELSE PRINT 'SF',@(X1,X0),X$(1,13)
1215 LET T2$(32,13)=X$
1220 IF T2$(53,16)=FILL(16) THEN LET T2$(53,16)=X$
1225 LET X0=3,X1=25,X3=6,GUI_ID=4025
1230 IF NUM(T2$(45,7))>0 THEN LET X=NUM(T2$(45,7)) ELSE LET X=-1
1235 LET X$=FND$(X)
1240 GOSUB GENINPUT; REM  "DATE"
1245 IF Y$="U" THEN GOTO 1195
1250 IF X<0 THEN LET X=0
1255 LET T2$(45,7)=STR(X)
1260 LET X0=1,X1=66,X3=3,X4=9,X$=T1$,GUI_ID=4030
1265 GOSUB GENINPUT; REM  "ENTRY NUMBER"
1270 IF Y$="U" THEN IF T2$(11,8)=FILL(8) THEN GOTO 1145 ELSE GOTO 1225
1275 IF X$="NEW" THEN GOSUB 3625
1280 CALL "GENCKIBN.PUB",X$,INVALID,OSGUI$; IF INVALID THEN LET Y$=""; IF GUI THEN GOSUB CLEAR_GLOBAL FI; GOTO 1260
1285 LET T1$(1,9)=X$
1290 LET X0=2,X1=64,X3=0,X4=2,X$=T2$(9,2),WINDID$="AMIBTYW1",GUI_ID=4035
1295 GOSUB GENINPUT; LET WINDID$=""; REM  "CLASS"
1300 IF Y$="U" THEN GOTO 1260
1302 LET X$=X$+FILL(X4-LEN(X$))
1305 READ (FILE[91],KNUM=0,KEY=X$,DOM=1310)IOL=AMIBTYPE
1306 LET TYPE_DESC$=CVS(TYPE_DESC$,3); REM Remove spaces
1307 GOTO 1315
1310 LET X9$="<< Code not defined in 'AMIBTYPE' File >>"; GOSUB CLEAR_GLOBAL; GOSUB GENERROR; GOTO 1290
1315 LET T2$(9,2)=X$; IF T2$(9,2)="63" AND VESSEL_FTZ$<>"Y" THEN IF GUI=0 THEN PRINT 'SB',@(39,5),"Pedimento #", ELSE PRINT (OSGUI.CHAN)'TITLE'(1080,"Pedimento #"),'SHOW'(1080,4057),'ENABLE'(4057)
1317 IF T2$(9,2)<>"63" OR VESSEL_FTZ$="Y" THEN IF GUI THEN PRINT (OSGUI.CHAN)'DISABLE'(4057)
1320 IF GUI THEN PRINT (OSGUI.CHAN)'SHOW'(2010),'TITLE'(2010,TYPE_DESC$) ELSE PRINT 'SF',@(67,2),TYPE_DESC$
1325 GOSUB 7823
1330 IF T2$(9,2)="36" OR T2$(9,2)="62" THEN IF GUI THEN PRINT (OSGUI.CHAN)'ENABLE'(4040); GOTO 1340 ELSE IF GUI=0 THEN GOTO 1340
1333 IF O2$(19,1)<>"1" THEN IF GUI THEN IF POS(T2$(9,2)="3335363739",2) THEN PRINT (OSGUI.CHAN)'ENABLE'(4280,4290) ELSE PRINT (OSGUI.CHAN)'DISABLE'(4280,4290)
1335 IF T2$(9,2)<>"63" THEN LET T2$(8,1)="N"; IF GUI THEN PRINT (OSGUI.CHAN)'DISABLE'(4040); GOTO 1360 ELSE GOTO 1360
1338 IF GUI THEN PRINT (OSGUI.CHAN)'ENABLE'(4040)
1340 LET X0=3,X1=64,X3=5,X4=1,X1$="YN",X$=T2$(8,1),GUI_ID=4040
1345 GOSUB GENINPUT; REM IBECC
1350 IF Y$="U" THEN GOTO 1290
1355 LET T2$(8,1)=X$
1360 IF VESSEL_FTZ$="Y" THEN GOTO 1410
1365 LET X0=5,X1=9,X3=0,X4=11,X$=T3$(1,11),GUI_ID=4045
1370 GOSUB GENINPUT; REM  "LOG #1"
1375 IF Y$="U" THEN GOTO 1290
1380 LET T3$(1,11)=X$
1385 LET X0=5,X1=24,X3=0,X4=11,X$=T3$(12,11),GUI_ID=4050
1390 GOSUB GENINPUT; REM  "LOG #2"
1395 IF Y$="U" THEN GOTO 1365
1400 LET T3$(12,11)=X$
1405 IF T2$(9,2)<>"63" THEN GOTO 1435 ELSE IF VESSEL_FTZ$<>"Y" THEN GOSUB PEDIMENTO; GOTO 1435
1415 LET X0=5,X1=51,X3=5,X4=1,X1$="YN",X$=T5$(20,1),GUI_ID=4055
1420 GOSUB GENINPUT; REM CASR INDICATOR
1425 IF Y$="U" THEN GOTO 1290
1430 LET T5$(20,1)=X$
1432 IF GUI THEN IF T5$(20,1)="Y" AND CUST$=SP_CUST$ THEN PRINT (OSGUI.CHAN)'ENABLE'(4225) ELSE PRINT (OSGUI.CHAN)'CLRTITLE'(4225),'DISABLE'(4225)
1435 LET X0=6,X1=9,X3=0,X4=2,X$=T3$(23,2),GUI_ID=4060
1440 GOSUB GENINPUT; REM  "DIST #"
1445 IF Y$="U" THEN GOTO 1290
1450 LET T3$(23,2)=X$
1455 LET X0=6,X1=26,X3=0,X4=2,X$=T3$(25,2),GUI_ID=4070
1460 GOSUB GENINPUT; REM  "PORT CODE"
1465 IF Y$="U" THEN GOTO 1435
1470 LET T3$(25,2)=X$
1475 READ (FILE[65],KEY=T3$(23,4),DOM=1490,KNUM=0)IOL=IPCNT2
1480 IF GUI THEN PRINT (OSGUI.CHAN)'SHOW'(2020),'TITLE'(2020,R22$(1,16)) ELSE PRINT 'SF',@(10,7),R22$(1,13),'SB',
1485 GOTO 1495
1490 LET X9$="<< Port Code not in Country/Port File >>"; GOSUB CLEAR_GLOBAL; GOSUB GENERROR; GOTO 1435
1495 IF T2$(53,16)=FILL(16) THEN LET T2$(53,16)=R22$(1,16)
1500 LET X0=6,X1=57,X3=0,X4=16,X$=T2$(53,16),WINDID$="IPTRNTW3",PROGID$="IPCNTU",GUI_ID=4080
1505 GOSUB GENINPUT; REM "FIRST U.S. PORT OF UNLADING"
1510 IF Y$="U" THEN GOTO 1435
1515 IF LEN(X$)=4 THEN READ (FILE[65],KEY=X$,KNUM=0,DOM=1520)IOL=IPCNT2; LET X$=R22$(1,16); IF GUI THEN PRINT (OSGUI.CHAN)'TITLE'(4080,X$) ELSE PRINT 'SF',@(X1,X0),X$
1520 LET T2$(53,16)=X$
1525 LET X0=7,X1=36,X3=6,X=NUM(T2$(1,7)),X$=FND$(X),GUI_ID=4090
1530 GOSUB GENINPUT; REM DATE
1535 IF Y$="U" THEN GOTO 1500
1540 IF X<0 THEN LET O7=5; GOSUB GENERROR; GOTO 1525
1545 LET T2$(1,7)=STR(X)
1546 LET X0=7,X1=59,X3=0,X4=12,X$=T5$(164,12),GUI_ID=4095
1547 GOSUB GENINPUT; REM  "G.O Number"
1548 IF Y$="U" THEN GOTO 1525
1549 LET T5$(164,12)=X$
1550 LET X0=9,X1=25,X3=0,X4=49,X$=T4$(21,49),WINDID$="IPTRNTW1",PROGID$="IPACI",GUI_ID=4100
1555 GOSUB GENINPUT; LET WINDID$=""; REM  "IMPORTED BY"
1560 IF Y$="U" THEN GOTO 1546
1565 LET T4$(21,49)=X$,ENTERED$=""
1567 IF LEN(X$)<7 THEN LET X$=X$+FILL(6-LEN(X$)); READ (FILE[50],KEY=X$,KNUM=0,DOM=1570)IOL=ARCUX; LET T4$(70,6)=C0$,X$=CVS(C1$,3),ADX$=CVS(C2$(1,30),3),ADX1$=CVS(C2$(31,30),3); LET ENTERED$=X$+FILL(1)+ADX$+FILL(1)+ADX1$; IF LEN(ENTERED$)>49 THEN LET ENTERED$=ENTERED$(1,49) FI; LET T4$(21,49)=ENTERED$
1568 IF GUI THEN PRINT (OSGUI.CHAN)'TITLE'(4100,T4$(21,49)) ELSE PRINT 'SF',@(X1,X0),T4$(21,49)
1570 IF VESSEL_FTZ$="Y" AND T5$(20,1)="Y" AND T3$(62,50)=FILL(50) THEN LET X$=CVS(CUST_NAME$(1,32),2)+" "+CVS(CUST_ADD$(1,30),2)+" "+CVS(CUST_ADD$(31,30),2)+" "+CUST_IRS$(1,12); IF LEN(X$)<63 THEN LET X$=X$+FILL(63-LEN(X$)) FI; LET T3$(62,50)=X$(1,50),T7$(2,13)=X$(51,13)
1575 LET X0=10,X1=14,X3=0,X4=63,X$=T3$(62,50)+T7$(2,13),WINDID$="IPTRNTW5",GUI_ID=4110
1580 IF IN_BOND_VIA$="T" THEN LET WINDID$="IPTCK W1"
1585 GOSUB GENINPUT; LET WINDID$=""; REM  "IN BOND VIA LINE 1"
1590 IF Y$="U" THEN GOTO 1550
1595 IF IN_BOND_VIA$<>"T" THEN GOTO 1635
1600 IF LEN(X$)>6 THEN LET X$=X$+FILL(X4-LEN(X$)); GOTO 1665
1605 LET K$=X$+FILL(6-LEN(X$)),X$=X$+FILL(X4-LEN(X$))
1610 READ (FILE[29],KNUM=0,KEY=K$,DOM=1665)IOL=IPTCKX
1615 LET X$(1,X4)=CVS(TC1$(1,24),3)+" "+CVS(TC5$(1,25),3)+" "+TC6$(1,12)
1620 IF GUI THEN PRINT (OSGUI.CHAN)'TITLE'(4110,X$) ELSE PRINT 'SF',@(X1,X0),X$
1625 IF VESSEL_FTZ$="Y" THEN LET T3$(27,35)=CVS(TC1$(1,23),3)+" "+TC6$(1,12)
1630 GOTO 1665
1635 IF LEN(X$)>4 THEN LET X$=X$+FILL(X4-LEN(X$)); GOTO 1665
1640 LET K$=X$+FILL(4-LEN(X$)),X$=X$+FILL(X4-LEN(X$))
1645 LET MOT$=""; READ (FILE[43],KNUM=0,KEY=K$,DOM=1665)IOL=IPCR
1647 LET MOT$=CY1$(5,2)
1650 LET I$=""; IF CY1$(47,12)<>FILL(12) THEN LET I$=" IRS #: "+CY1$(47,12)
1655 LET X$(1,X4)=CVS(CY1$(7,35),3)+I$
1660 IF GUI THEN PRINT (OSGUI.CHAN)'TITLE'(4110,X$) ELSE PRINT 'SF',@(X1,X0),X$
1665 LET T3$(62,50)=X$(1,50),T7$(2,13)=X$(51,13)
1670 IF T3$(62,50)=FILL(50) AND T3$(132,63)=FILL(63) THEN GOTO 1725
1675 IF VESSEL_FTZ$="Y" AND T5$(20,1)="Y" THEN LET T3$(27,35)=T3$(62,35)
1677 LET X0=11,X1=14,X3=0,X4=63,X$=T3$(132,63),WINDID$="IPTRNTW5",GUI_ID=4115
1680 IF IN_BOND_VIA$="T" THEN LET WINDID$="IPTCK W1"
1682 GOSUB GENINPUT; LET WINDID$=""; REM  "IN BOND VIA LINE 2"
1685 IF Y$="U" THEN GOTO 1575
1687 IF IN_BOND_VIA$<>"T" THEN GOTO 1702
1689 IF LEN(X$)>6 THEN LET X$=X$+FILL(X4-LEN(X$)); GOTO 1716
1690 LET K$=X$+FILL(6-LEN(X$)),X$=X$+FILL(X4-LEN(X$))
1692 READ (FILE[29],KNUM=0,KEY=K$,DOM=1716)IOL=IPTCKX
1694 LET X$(1,X4)=CVS(TC1$(1,24),3)+" "+CVS(TC5$(1,25),3)+" "+TC6$(1,12)
1696 IF GUI THEN PRINT (OSGUI.CHAN)'TITLE'(4115,X$) ELSE PRINT 'SF',@(X1,X0),X$
1698 IF VESSEL_FTZ$="Y" THEN LET T3$(27,35)=CVS(TC1$(1,36),3)+" "+TC6$(1,12)
1700 GOTO 1716
1702 IF LEN(X$)>4 THEN LET X$=X$+FILL(X4-LEN(X$)); GOTO 1716
1704 LET K$=X$+FILL(4-LEN(X$)),X$=X$+FILL(X4-LEN(X$))
1706 READ (FILE[43],KNUM=0,KEY=K$,DOM=1716)IOL=IPCR
1710 LET I$=""; IF CY1$(47,12)<>FILL(12) THEN LET I$=" IRS #: "+CY1$(47,12)
1712 LET X$(1,X4)=CVS(CY1$(7,35),3)+I$
1714 IF GUI THEN PRINT (OSGUI.CHAN)'TITLE'(4115,X$) ELSE PRINT 'SF',@(X1,X0),X$
1716 LET T3$(132,63)=X$
1725 LET X0=12,X1=10,X3=0,X4=20,X$=T3$(112,20),WINDID$="IPTRNTW3",PROGID$="IPCNTU",GUI_ID=4120
1730 GOSUB GENINPUT; LET WINDID$="",PROGID$=""; REM  "CUSTOMS"
1735 IF Y$="U" THEN IF T3$(62,50)=FILL(50) THEN GOTO 1575 ELSE GOTO 1680
1740 IF LEN(X$)=4 THEN READ (FILE[65],KEY=X$,DOM=1755)IOL=IPCNT2 ELSE GOTO 1755
1745 LET X$=X$+"-"+R22$(1,15)
1750 IF GUI THEN PRINT (OSGUI.CHAN)'TITLE'(4120,X$) ELSE PRINT @(X1,X0),'SF',X$
1755 LET T3$(112,20)=X$
1760 IF T4$(1,20)=FILL(20) THEN IF VESSEL_FTZ$="Y" AND POS(T2$(9,2)="6768",2)>0 THEN LET T4$(1,20)="SEC 309 TA 99900"
1765 LET X0=12,X1=57,X3=0,X4=20,X$=T4$(1,20),WINDID$="IPTRNTW4",PROGID$="IPCNTF",GUI_ID=4130
1770 GOSUB GENINPUT; LET WINDID$="",PROGID$=""; REM  "DESTINATION"
1775 IF Y$="U" THEN GOTO 1725
1780 IF LEN(X$)=5 THEN READ (FILE[66],KEY=X$,DOM=1785)IOL=IPCNT3; LET X$=X$+"-"+R31$(1,14); IF GUI THEN PRINT (OSGUI.CHAN)'TITLE'(4130,X$) ELSE PRINT 'SF',@(X1,X0),X$
1785 LET T4$(1,20)=X$
1790 LET X0=13,X1=12,X3=0,X4=65,X$=T4$(96,65),WINDID$="IPTRNTW1",PROGID$="IPACI",GUI_ID=4140
1795 GOSUB GENINPUT; LET WINDID$=""; REM  "CONSIGNEE"
1800 IF Y$="U" THEN GOTO 1765
1802 IF X$=FILL(65) OR LEN(X$)=0 THEN GOTO 1810
1803 IF CVS(X$,4)="NAME" THEN CALL "IPNAME",FILE[50],X$,5,OSGUI$; IF GUI THEN PRINT (OSGUI.CHAN)'TITLE'(GUI_ID,X$) ELSE PRINT 'SF',@(X1,X0),X$
1805 IF LEN(X$)<7 THEN LET X$=X$+FILL(6-LEN(X$)); READ (FILE[50],KEY=X$,KNUM=0,DOM=1810)IOL=ARCUX; LET L2$(53,6)=X$; LET X$=CVS(C1$,3)+FILL(1)+CVS(C2$(1,30),3)+FILL(1)+CVS(C2$(31,30),3) ELSE GOTO 1810
1807 IF LEN(X$)>65 THEN LET X$=X$(1,65) FI; IF GUI THEN PRINT (OSGUI.CHAN)'TITLE'(4140,X$) ELSE PRINT 'SF',@(X1,X0),X$
1810 LET T4$(96,65)=X$
1815 LET X0=14,X1=25,X2=0,X3=0,X4=20,X$=T4$(76,20),X9=0,WINDID$="IPTRNTW4",PROGID$="IPCNTF",GUI_ID=4150
1820 GOSUB GENINPUT; LET WINDID$="",PROGID$=""; REM  "PORT OF LADING"
1825 IF Y$="U" THEN GOTO 1790
1830 LET X$=CVS(X$,2)
1835 IF LEN(X$)<>5 THEN GOTO 1860
1840 READ (FILE[66],KEY=X$,KNUM=0,DOM=1860)IOL=IPCNT3; LET X$=X$+"-"+R31$(1,14); IF GUI THEN PRINT (OSGUI.CHAN)'TITLE'(4150,X$) ELSE PRINT 'SF',@(X1,X0),X$
1845 IF T5$(65,15)<>FILL(15) THEN GOTO 1860
1850 READ (FILE[64],KEY=R31$(31,2),DOM=1860)IOL=IPCNT1
1855 LET T5$(65,15)=R12$(1,16)
1860 LET T4$(76,20)=X$
1865 LET X0=14,X1=54,X3=0,X4=16,X$=T5$(108,16),GUI_ID=4160
1870 GOSUB GENINPUT; REM  "B/L #"
1875 IF Y$="U" THEN GOTO 1815
1880 LET T5$(108,16)=X$
1885 LET X0=15,X1=11,X3=6
1890 IF NUM(T5$(13,7))>0 THEN LET X=NUM(T5$(13,7)) ELSE LET X=-1
1895 LET X$=FND$(X),GUI_ID=4170
1900 GOSUB GENINPUT; REM  "SAILING "
1905 IF Y$="U" THEN GOTO 1865
1910 IF X<0 THEN LET X=0
1915 LET T5$(13,7)=STR(X)
1920 LET X0=15,X1=56,X3=0,X4=16,X$=T5$(148,16),GUI_ID=4180
1925 GOSUB GENINPUT; REM HOUSE #
1930 IF Y$="U" THEN GOTO 1885
1935 LET T5$(148,16)=X$
1940 LET X0=16,X1=18,X3=0,X4=18,X$=T5$(21,18),WINDID$="IPTRNTW5",PROGID$="IPCAR",GUI_ID=4190
1945 GOSUB GENINPUT; LET WINDID$="",PROGID$=""; REM  "IMPORTED ON"
1950 IF Y$="U" THEN GOTO 1920
1955 LET X$=CVS(X$,2)
1960 IF LEN(X$)<5 THEN LET X$=X$+FILL(4-LEN(X$)); READ (FILE[43],KEY=X$,KNUM=0,DOM=1965)IOL=IPCR; LET X$=CY1$(7,18),GOODS_AT$=CY1$(43,4); IF GUI THEN PRINT (OSGUI.CHAN)'TITLE'(4190,X$) ELSE PRINT 'SF',@(X1,X0),X$
1965 LET T5$(21,18)=X$
1970 IF T5$(39,8)=FILL(8) THEN LET T5$(39,8)=CY1$(59,2)
1975 LET X0=16,X1=44,X3=0,X4=8,X$=T5$(39,8),GUI_ID=4200
1980 GOSUB GENINPUT; REM  "FLAG"
1985 IF Y$="U" THEN GOTO 1940
1990 LET T5$(39,8)=X$
1995 LET X0=16,X1=58,X3=6,GUI_ID=4210
2000 IF NUM(T5$(47,7))>0 THEN LET X=NUM(T5$(47,7)) ELSE LET X=-1
2005 LET X$=FND$(X)
2010 GOSUB GENINPUT; REM  "ON DATE"
2015 IF Y$="U" THEN GOTO 1975
2020 IF X<0 THEN LET X=0
2025 LET T5$(47,7)=STR(X)
2030 IF T5$(55,10)=FILL(10) THEN LET T5$(55,10)=T4$(76,20)
2035 LET X0=17,X1=6,X3=0,X4=10,X$=T5$(55,10),GUI_ID=4220
2040 GOSUB GENINPUT; REM  "VIA"
2045 IF Y$="U" THEN GOTO 1995
2050 LET T5$(55,10)=X$
2060 IF T5$(20,1)<>"Y" OR CUST$<>SP_CUST$ THEN IF Y$="U" THEN GOTO 2030 ELSE IF T2$(9,2)<>"63" THEN LET T7$(15,45)="" FI; GOTO 2115
2065 IF GUI THEN PRINT (OSGUI.CHAN)'ENABLE'(4225)
2070 LET X0=17,X1=28,X3=0,X4=45,X$=T7$(15,45),WINDID$="IPTCK W1",GUI_ID=4225
2075 GOSUB GENINPUT; LET WINDID$=""; REM TO BE DRAYED BY
2080 IF Y$="U" THEN GOTO 2035
2085 IF LEN(X$)>6 THEN GOTO 2110
2090 LET X$=X$+FILL(X4-LEN(X$))
2095 READ (FILE[29],KNUM=0,KEY=X$(1,6),DOM=2110)IOL=IPTCKX
2100 LET X$(1,X4)=CVS(TC1$(1,36),2)+" "+TC6$(1,12)
2105 IF GUI THEN PRINT (OSGUI.CHAN)'TITLE'(4225,X$) ELSE PRINT 'SF',@(X1,X0),X$
2110 LET T7$(15,45)=X$
2115 LET X0=18,X1=16,X3=0,X4=15,X$=T5$(65,15),GUI_ID=4230
2120 GOSUB GENINPUT; REM  "EXPORTED FROM "
2125 IF Y$="U" THEN GOTO 2035
2130 LET T5$(65,15)=X$
2135 IF NUM(T5$(80,7))=0 THEN LET T5$(80,7)=T5$(13,7)
2140 LET X0=18,X1=37,X3=6,GUI_ID=4240
2145 IF NUM(T5$(80,7))>0 THEN LET X=NUM(T5$(80,7)) ELSE LET X=-1
2150 LET X$=FND$(X)
2155 GOSUB GENINPUT; REM  "ON DATE"
2160 IF Y$="U" THEN GOTO 2115
2165 IF X<0 THEN LET X=0
2170 LET T5$(80,7)=STR(X)
2175 IF T5$(88,20)=FILL(20) THEN LET T5$(88,20)=GOODS_AT$
2180 LET X0=18,X1=57,X3=0,X4=20,X$=T5$(88,20),WINDID$="IPTRNTW2",PROGID$="IPLCGM",GUI_ID=4250
2185 GOSUB GENINPUT; LET WINDID$="",PROGID$=""; REM  "GOODS AT"
2190 IF Y$="U" THEN GOTO 2140
2195 REM IF N0$<>"TRAN" THEN GOTO 2540
2200 LET X$=CVS(X$,2)
2205 IF LEN(X$)<>4 THEN GOTO 2235
2210 READ (FILE[42],KEY=X$(1,4),KNUM=0,DOM=2235)IOL=IPLCG
2215 LET T5$(88,20)=LC0$+"-"+LC1$
2220 IF GUI THEN PRINT (OSGUI.CHAN)'TITLE'(4250,T5$(88,20)) ELSE PRINT 'SF',@(X1,X0),T5$(88,20)
2225 GOTO 2240
2230 LET X9$="<< Code not in Customer Codes File >>"; GOSUB CLEAR_GLOBAL; GOSUB GENERROR; GOTO 2175
2235 LET T5$(88,20)=X$
2240 IF T3$(27,35)=FILL(35) THEN LET T70K$=T3$(62,50)+T7$(2,13),T70K=POS("-"=T70K$,1); IF T70K>23 THEN LET T3$(27,35)=T70K$(1,22)+FILL(1)+T70K$(T70K-2,12) ELSE LET T3$(27,35)=T3$(62,35); REM BRING IN INBOND VIA INFORMATION
2242 REM IF T3$(27,35)=FILL(35) THEN IF POS(T2$(9,2)="35376162",2)>0 THEN LET T3$(27,35)=T3$(62,50) ELSE LET T3$(27,35)=L1$(56,22)
2245 LET X0=19,X1=10,X3=0,X4=35,X$=T3$(27,35),WINDID$="IPTRNTW5",PROGID$="IPCAR",GUI_ID=4260
2250 GOSUB GENINPUT; LET WINDID$=""; LET PROGID$=""; REM CARRIER
2255 IF Y$="U" THEN GOTO 2175
2260 IF LEN(X$)>4 THEN GOTO 2285
2265 LET X$=X$+FILL(4-LEN(X$))
2270 LET MOT$=""; READ (FILE[43],KNUM=0,KEY=X$,DOM=2285)IOL=IPCR
2272 LET MOT$=CY1$(5,2)
2275 LET T3$(27,35)=CY1$(7,35); IF POS(" "<>T3$(27,35),-1)<23 THEN LET T3$(27,35)=CVS(T3$(27,22),2)+" "+CY1$(47,12) FI; IF GUI THEN PRINT (OSGUI.CHAN)'TITLE'(4260,T3$(27,35)) ELSE PRINT 'SF',@(X1,X0),T3$(27,35)
2280 GOTO 2290
2285 LET T3$(27,35)=X$+FILL(X4-LEN(X$))
2290 LET X0=19,X1=55,X3=0,X4=10,X$=T5$(124,10),GUI_ID=4270
2295 GOSUB GENINPUT; REM "SEAL NUMBER"
2300 IF Y$="U" THEN GOTO 2245
2301 LET T5$(124,10)=X$+FILL(X4-LEN(X$))
2302 LET X0=19,X1=75,X3=0,X4=2,X$=T5$(11,2),WINDID$="RMOPMTW1",PROGID$="RMOPMT",GUI_ID=4275
2303 GOSUB GENINPUT; LET WINDID$=""; REM OPERATOR CODE
2304 LET T5$(11,2)=X$
2308 IF !(FORCE_OPERATOR) AND T5$(11,2)=FILL(2) THEN GOTO 2313
2309 READ (FILE[71],KNUM=0,KEY=T5$(11,2),DOM=2312)IOL=RMOPCD
2310 LET T6$(25,20)=CVS(OP1$(1,20),2)+" "+CVS(OP1$(21,15),2)
2311 GOTO 2313
2312 LET X9$="<< Enter a valid Operator Code >>"; GOSUB CLEAR_GLOBAL; GOSUB GENERROR; GOTO 2302
2313 IF POS(T2$(9,2)="33353637396263",2)=0 THEN GOTO 2365
2314 IF O2$(19,1)="1" THEN GOTO 2365
2315 IF GUI THEN PRINT (OSGUI.CHAN)'ENABLE'(4280,4290); GOSUB CLEAR_GLOBAL
2318 LET X0=20,X1=11,X3=1,X1$=M6$,X4=LEN(X1$),X=NUM(T6$(45,5)),GUI_ID=4280
2320 GOSUB GENINPUT; REM "BOND AMT"
2325 IF Y$="U" THEN GOTO 2302
2330 LET T6$(45,5)=STR(X:X1$)
2335 LET X0=20,X1=36,X3=1,X1$=M6$,X4=LEN(X1$),X=NUM(T6$(50,5)),GUI_ID=4290
2340 GOSUB GENINPUT; REM WITHDRAWAL
2345 IF Y$="U" THEN GOTO 2315
2350 LET T6$(50,5)=STR(X:X1$)
2355 LET BALANCE$=STR(NUM(T6$(45,5))-NUM(T6$(50,5)):M6$)
2360 IF GUI THEN PRINT (OSGUI.CHAN)'TITLE'(2040,BALANCE$) ELSE PRINT 'SF',@(55,X0),NUM(T6$(45,5))-NUM(T6$(50,5)):M6$
2365 REM   ***** SAVE HEADER RECORD *****************************
2370 LET O7=2; GOSUB GENERROR
2375 IF Y$="U" THEN GOTO 2245
2380 IF Y$<>"P" THEN GOTO 2370
2385 WRITE (FILE[2])IOL=IPTR1X
2386 IF PRE_ALERT=0 THEN GOTO 2391
2387 IF PREALERT_REF$<>"" THEN IF GUI THEN PRINT (OSGUI.CHAN)'HIDE'(0)
2390 IF NEW THEN CALL "IPPASP",ERR=2391,T0$,"2",OSGUI$; REM PRE-ALERT PROCESS STAMP
2391 IF POS(T2$(9,1)="3")=0 THEN GOTO 2393
2392 IF O2$(19,1)="1" THEN IF NEW THEN IF (WRITELOG OR L1$(15,11)=FILL(11)) THEN GOSUB PIECES; LET YDISABLE$=""; REM WAREHOUSE LINK AND LOG BOOK REF. DOES NOT EXIST.
2393 LET L0$=T0$; WRITE (FILE[13])IOL=IPLGX
2395 REM *************** SECOND SCREEN ******************************
2400 LET SCREEN=2,Y$=""
2405 IF GUI THEN GOSUB GUI_PROMPTS1 ELSE GOSUB PROMPTS
2410 READ (FILE[3],KEY=T0$,DOM=2415)
2415 IF POS(T2$(9,2)="353637",2)=0 THEN LET MAXLINE=13 ELSE IF T2$(8,1)="Y" THEN LET MAXLINE=11 ELSE LET MAXLINE=10
2420 IF GUI THEN GOSUB GUI_DATA1; GOSUB ENABLE_MAXLINE; GOSUB CLEAR_GLOBAL ELSE GOSUB DATA2
2422 LET QP=1
2425 IF O2$(19,1)<>"1" THEN GOTO 2470
2430 IF WHERETO=2 THEN LET WHERETO=0; LET NEW=0; LET LINK_BY$=FILL(1); GOTO 2470
2435 LET X8$="<< Enter <S>hipper or <W>arehouse Receipt >>"; GOSUB GENERROR
2440 IF GUI THEN PRINT (OSGUI.CHAN)'ENABLE'(4000)
2445 LET X0=1,X1=52,X3=5,X1$="SW ",X4=1,X$=LINK_BY$,GUI_ID=4000
2450 GOSUB GENINPUT; LET X8$=" "; GOSUB GENERROR
2455 IF Y$="U" THEN IF GUI=0 THEN LET SCREEN=1; GOSUB PROMPTS; GOSUB DATA; LET NEW=0; GOTO 2175
2460 IF Y$="U" THEN IF GUI THEN LET SCREEN=1; GOSUB PROMPTS; GOSUB DATA; GOSUB CLEAR_GLOBAL; GOSUB ENABLE_FIELDS; LET NEW=0; GOTO 2175
2465 LET LINK_BY$=X$
2470 IF LINK_BY$="S" THEN IF GUI THEN LET OLD_OSGUI$=OSGUI$,OSGUI$=OSGUI_IPSCR$ FI; RUN "IPSCR" ELSE IF LINK_BY$="W" THEN IF GUI THEN LET OLD_OSGUI$=OSGUI$,OSGUI$=OSGUI_IPSER$ FI; RUN "IPSER"
2475 LET GUI_POS=4010,START_POS=1
2480 FOR I9=START_POS TO MAXLINE
2485 GOSUB 3250; REM READ RECORDS
2490 IF NEW=0 OR W8$<>FILL(6) THEN GOTO 2535; REM skip when not new or copied from anothe ref
2495 IF I9<>1 THEN IF VESSEL_FTZ$<>"Y" THEN GOTO 2535 ELSE GOTO 2525
2500 IF DEF_PIECES_WEIGHT$<>"Y" THEN GOTO 2535
2505 LET X=L3[3],X$=""; IF X=1 THEN LET X$="1 CASE" ELSE IF X>1 THEN LET X$=STR(X)+" CASES"
2510 LET D4[1]=NUM(STR(L3[1]:M3$,ERR=2515))
2515 LET D3$(1,15)=X$,D4[0]=NUM(STR(L3[2]*2.2046:M4$,ERR=2530))
2520 GOTO 2530
2525 IF I9=3 THEN LET D3$(1,25)="VESSEL ENGAGED IN FOREIGN" ELSE IF I9=4 THEN LET D3$(1,24)="TRADE - NO EXCEPTIONS" ELSE GOTO 2535
2530 IF GUI=0 THEN PRINT 'SF',@(15,I9+3),D3$,@(41),D4[0]:M4$,@(51),D4[1]:M3$
2535 LET X0=I9+3,X1=2,X3=0,X4=12,X$=D2$,GUI_ID=GUI_POS
2540 GOSUB GENINPUT; REM  "MARK & NUMBERS"
2545 IF Y$<>"U" THEN GOTO 2570
2550 IF GUI THEN IF I9=1 THEN IF O2$(19,1)="1" THEN EXITTO 2435 ELSE GOSUB DESTROY_GUI_WINDOW; LET SCREEN=1; GOSUB PROMPTS; GOSUB DATA; GOSUB CLEAR_GLOBAL; GOSUB ENABLE_FIELDS; EXITTO 2175
2555 IF GUI=0 THEN IF I9=1 THEN IF O2$(19,1)="1" THEN EXITTO 2435 ELSE LET SCREEN=1; GOSUB PROMPTS; GOSUB DATA; EXITTO 2175
2560 LET I9=I9-1,GUI_POS=GUI_POS-70
2565 GOTO 2485
2570 IF POS(X$="ENDend")>0 OR Y$="P" THEN IF I9>4 OR VESSEL_FTZ$<>"Y" THEN EXITTO 2795
2575 LET D2$(1,12)=X$
2580 LET X0=I9+3,X1=15,X3=0,X4=25,X$=D3$,GUI_ID=GUI_POS+10
2585 GOSUB GENINPUT; REM  "DESCRIPTION"
2590 IF Y$="U" THEN GOTO 2535
2595 LET D3$(1,25)=X$
2600 LET X0=I9+3,X1=41,X3=1,X1$=M4$,X4=LEN(X1$),X=D4[0],GUI_ID=GUI_POS+20
2605 GOSUB GENINPUT; REM WEIGHT
2610 IF Y$="U" THEN GOTO 2580
2615 LET D4[0]=X
2620 LET X8$="<< Enter 'K' to convert weight to Pounds; Leave blank otherwise >>"; GOSUB GENERROR
2625 LET X0=I9+3,X1=49,X3=3,X4=1,X$=" ",GUI_ID=GUI_POS+30
2630 GOSUB GENINPUT; REM  "L/K"
2635 LET X8$=" "; GOSUB GENERROR
2640 IF Y$="U" THEN GOTO 2600
2645 IF X$<>"K" THEN IF GUI THEN PRINT (OSGUI.CHAN)'TITLE'(GUI_POS+30,FILL(1)) ELSE PRINT @(X1,X0),FILL(1) FI; GOTO 2660
2650 LET D4[0]=NUM(STR(D4[0]*2.2046:M4$,ERR=2655))
2655 IF GUI THEN PRINT (OSGUI.CHAN)'TITLE'(GUI_POS+20,FNGUINUM$(D4[0],M4$,GUI_POS+20)),'TITLE'(GUI_POS+30," ") ELSE PRINT @(41,X0),D4[0]:M4$
2660 LET X8$="<< Enter Value or 'E' to estimate based on $10 per Pound >>"; GOSUB GENERROR
2665 LET X0=I9+3,X1=51,X3=3,X1$=M3$,X4=LEN(X1$),X$=STR(D4[1]:X1$),GUI_ID=GUI_POS+40
2670 GOSUB GENINPUT; REM  "VALUE"
2675 LET X8$=" "; GOSUB GENERROR
2680 IF Y$="U" THEN GOTO 2620
2685 IF X$="E" THEN LET T2$(52,1)="Y",X$=STR(10*D4[0]:X1$,ERR=2695); GOTO 2695
2690 IF D4[1]>0 AND D4[1]<>NUM(X$,ERR=2695) THEN LET T2$(52,1)="N"; REM AMOUNT WAS CHANGED
2695 LET D4[1]=NUM(X$,ERR=2715)
2700 IF NO_NEW_O$="Y" AND I9=1 AND D4[1]=0 THEN LET X9$="<< Must enter Value >>"; GOSUB GENERROR; GOTO 2660
2705 IF GUI THEN PRINT (OSGUI.CHAN)'TITLE'(GUI_POS+40,FNGUINUM$(NUM(X$),X1$,GUI_POS+40)) ELSE PRINT 'SF',@(X1,X0),NUM(X$):X1$
2710 GOTO 2720
2715 LET O7=6; GOSUB GENERROR; GOTO 2665
2720 LET X0=I9+3,X1=59,X3=1,X1$=M12$,X4=LEN(X1$),X=D4[2],GUI_ID=GUI_POS+50
2725 GOSUB GENINPUT; REM  "RATE"
2730 IF Y$="U" THEN GOTO 2660
2735 LET D4[2]=X
2740 IF GUI=0 THEN IF X=0 THEN PRINT @(X1,X0),FILL(LEN(M2$)) ELSE PRINT 'SF',@(X1,X0),X:M2$
2745 IF GUI THEN IF X<>0 THEN PRINT (OSGUI.CHAN)'TITLE'(GUI_POS+50,FNGUINUM$(X,M2$,GUI_POS+50))
2750 IF D4[3]=0 THEN LET D4[3]=D4[2]*D4[1]/100
2755 LET X0=I9+3,X1=67,X3=1,X1$=M5$,X4=LEN(X1$),X=D4[3],GUI_ID=GUI_POS+60
2760 GOSUB GENINPUT; REM  "DUTY"
2762 LET A$=STBL("DESTID2",ERR=2765); LET Y$="U"
2765 IF Y$="U" THEN GOTO 2720
2770 LET D4[3]=X
2775 WRITE (FILE[3])IOL=IPTR2X
2780 IF JAF_AWB$="Y" AND D3$(2,4)="AWB#" THEN GOSUB JAF_AWB_LOG
2785 LET GUI_POS=GUI_POS+70
2790 NEXT I9
2795 LET W8$=FILL(6)
2800 GOSUB 3560; REM Calculate Totals
2805 IF N0$<>"TRAN" THEN GOTO 2875
2810 IF GUI THEN PRINT (OSGUI.CHAN)'ENABLE'(4915,4920,4930)
2815 LET X0=19,X1=8,X3=0,X4=12,X$=T6$(1,12),GUI_ID=4915
2820 GOSUB GENINPUT; REM  "AWB #"
2825 IF Y$="U" THEN GOTO 2470
2830 LET T6$(1,12)=X$
2835 LET X0=19,X1=42,X3=1,X1$=M8$,X4=LEN(X1$),X=NUM(T6$(13,6)),GUI_ID=4920
2840 GOSUB GENINPUT; REM  "CHARGES"
2845 IF Y$="U" THEN GOTO 2815
2850 LET T6$(13,6)=STR(X:X1$)
2855 LET X0=19,X1=70,X3=1,X1$=M9$,X4=LEN(X1$),X=NUM(T6$(19,6)),GUI_ID=4930
2860 GOSUB GENINPUT; REM  "MANIFEST #"
2865 IF Y$="U" THEN GOTO 2835
2870 LET T6$(19,6)=STR(X:X1$)
2875 LET X0=20,X1=11,X3=0,X4=20,X$=T6$(25,20),GUI_ID=4940
2880 GOSUB GENINPUT; REM  "OPERATOR NAME"
2885 IF Y$<>"U" THEN GOTO 2905
2890 IF N0$="TRAN" THEN GOTO 2855
2895 LET START_POS=MAXLINE,GUI_POS=4850
2900 IF GUI=1 THEN GOTO 2480 ELSE GOTO 2480
2905 LET T6$(25,20)=X$
2910 IF T2$(8,1)<>"Y" THEN GOTO 2975
2915 IF GUI THEN PRINT (OSGUI.CHAN)'ENABLE'(4950,4960,14960),'TITLE'(4950,T5$(1,10)),'TITLE'(4960,T5$(144,4))
2920 LET X0=20,X1=39,X3=0,X4=10,X$=T5$(1,10),GUI_ID=4950
2925 GOSUB GENINPUT; REM BOND #
2930 IF Y$="U" THEN GOTO 2875
2935 LET T5$(1,10)=X$
2940 LET X0=20,X1=64,X3=0,X4=4,X$=T5$(144,4),WINDID$="IPTRNTW3",PROGID$="IPCNTU",GUI_ID=4960
2945 GOSUB GENINPUT; LET WINDID$="",PROGID$=""; REM PORT CODE
2950 IF Y$="U" THEN GOTO 2920
2955 READ (FILE[65],KEY=X$,DOM=2965)
2960 GOTO 2970
2965 LET X9$="<< Port code not in US Port File >>"; GOSUB GENERROR; GOTO 2940
2970 LET T5$(144,4)=X$
2975 REM ****************** SAVE RECORD *********************************
2980 LET O7=2; GOSUB GENERROR
2985 IF Y$="U" THEN GOTO 2875
2990 IF Y$<>"P" THEN GOTO 2975
2995 WRITE (FILE[2])IOL=IPTR1X
2996 GOTO 3000; REM IF IND_UNFORM<>1 OR Y$="M" OR ASCI_LINK=0 THEN GOTO 3000
2997 LET X8$="<< Creating PDF Files, Please wait ...>>"; GOSUB CLEAR_GLOBAL; GOSUB GENERROR
2998 LET PDF_AUTOM=1,LAST_T0$=T0$,LAST_D1$=D1$; RUN "IPTRP1"
2999 IF PDF_AUTOM THEN LET T0$=LAST_T0$,D1$=LAST_D1$
3000 IF WRITELOG<>1 THEN IF L1$(15,11)<>FILL(11) THEN GOTO 3070
3005 IF CY0$<>FILL(4) THEN LET L2$(62,4)=CY0$; REM SAVE CARRIER CODE
3010 IF C0$<>FILL(6) THEN LET L2$(53,6)=C0$; REM SAVE CONSIGNEE CODE
3015 LET L0$=T0$,L4[0]=NUM(T2$(1,7)),L1$(87,12)=T4$(76,20),L1$(103,4)=T3$(23,4),L4[3]=NUM(T2$(45,7)),L1$(56,18)=T5$(21,18),L4[1]=NUM(T5$(47,7)),L3[2]=A1[0],L3[0]=A1[1],L3[1]=L3[0],L3[5]=A1[3],L3[4]=NUM(T6$(13,6)),L1$(99,2)=T6$(25,2),L1$(13,2)=T2$(9,2),L1$(110,1)="N",L1$(15,11)=T1$
3017 LET L1$(99,2)=T5$(11,2)
3020 LET L1$(26,30)=T4$(96,30); REM LET L1$(26,30)=T4$(21,55)
3025 LET X$=""; IF T5$(108,16)<>FILL(16) THEN LET X$="10" ELSE IF T6$(1,12)<>FILL(12) THEN LET X$="40"
3030 DIM AB0$(10),AB1$(30)
3035 LET AB0$(1,6)=L0$,SEQ=1,AB0$(7,4)=STR(SEQ:"0000")
3040 IF T5$(108,16)<>FILL(16) THEN LET AB1$(1,17)="M"+T5$(108,16) ELSE IF T6$(1,12)<>FILL(12) THEN LET AB1$(1,17)="M"+T6$(1,12)
3045 IF AB1$(1,30)<>FILL(30) THEN WRITE (FILE[10])IOL=IPAWBX; LET SEQ=SEQ+1
3050 IF T5$(148,16)<>FILL(16) THEN LET AB1$(1,17)="H"+T5$(148,16),AB0$(7,4)=STR(SEQ:"0000"); WRITE (FILE[10])IOL=IPAWBX
3052 IF MOT$<>"" THEN LET L2$(66,2)=MOT$; REM Get MOT from Carrier F/M
3055 IF L2$(66,2)=FILL(2) THEN LET L2$(66,2)=X$
3065 IF O2$(19,1)<>"1" THEN GOSUB PIECES; REM WAREHOUSE LINK, THIS WAS ALREADY DONE
3070 IF L0$=FILL(6) THEN GOTO 3090
3075 LET L1$(3,1)="T"
3080 WRITE (FILE[13])IOL=IPLGX
3082 IF QP_RCD$="" THEN LET QP=1; GOSUB QUICK_PRINT
3084 LET QP_RCD$=""
3090 LET Y$="",SCREEN=1
3095 IF (DO_AUTO$<>"Y" AND BILLING_AUTO$<>"Y") THEN LET VISITED_ONE=0; GOTO 3125
3100 LET NOT_AN_ENTRY=1,AUTO_REF$=T0$
3101 REM  IF GUI THEN IF PREALERT_REF$="" OR LEN(PREALERT_REF$)=0 THEN LET OSGUI_IPTRNT$=OSGUI$,OSGUI_IPTRNT.CHAN=OSGUI.CHAN; LET OSGUI$=OSGUI_IPNEXT$ ELSE LET OSGUI_IPTRNT$=OSGUI$; PRINT (OSGUI.CHAN)'HIDE'(0)
3105 GOSUB NEXT_PROGRAM_TO_RUN
3106 REM IF GUI THEN LET OSGUI$=OSGUI_IPTRNT$
3107 REM IF GUI THEN PRINT (OSGUI.CHAN)'CONTEXT'(OSGUI.CUR_CONTEXT[1]); LET OSGUI.CONTEXT_POINTER=1; REM GOSUB RESET_WINDOW
3110 REM IF XN2$="N" AND XN3$="N" THEN GOTO 3125
3115 REM RESET; LET OSGUI$=NEXT_OSGUI$[NEXT_TO_RUN]
3120 REM RUN NEXT_PGM$[NEXT_TO_RUN]
3125 REM IF PREALERT_REF$="" THEN GOTO 3155
3130 REM FOR I=1 TO 70
3135 REM CLOSE (FILE[I],ERR=3140)
3140 REM LET FILE[I]=0
3145 REM NEXT I
3150 REM RUN "IPPACI1"
3158 GOTO 0010
3160 PIECES: REM *** Window to get PCS from Entry TYpe 21 - This routine is called from lines 2392 & 3065 - Based on O2$(19,1) ***
3161 LET POP_WIND=1; IF GUI THEN GOSUB GUI_PROMPTS2; GOSUB GUI_DATA2 ELSE PRINT @(2,22),"Original Ref.",@(24),"Whse Balance",@(45),"Pieces",@(60),"Customer"
3162 GOSUB CLEAR_GLOBAL; LET Y$="",LOG_REF$="",OLD_YDISABLE$=YDISABLE$; LET YDISABLE$="SDX"
3163 LET X0=22,X1=16,X3=3,X4=6,X$=LL0$,WINDID$="IPTRNTW6",GUI_ID=4000
3164 GOSUB GENINPUT; LET WINDID$=""; REM  "REF. #"
3165 IF Y$="U" THEN GOTO 3163
3166 IF FNE(X$) THEN LET LL0$=M0$; GOTO 3180; REM LET X9$="<< Enter Original Warehouse Ref. >>"; GOSUB GENERROR; GOSUB CLEAR_GLOBAL; GOTO 3163
3167 LET LL0$=STR(NUM(X$,ERR=3175):M0$); LET T5$(134,6)=LL0$
3168 IF LL0$=M0$ THEN GOTO 3163
3170 READ (FILE[13],KEY=LL0$,DOM=3175)IOL=IPLGX_ALT
3171 IF GUI THEN PRINT (OSGUI.CHAN)'TITLE'(2000,LL2$(115,8)) ELSE PRINT 'SF',@(37),LL2$(115,8)
3172 IF LL1$(13,2)<>"21" AND LL1$(13,2)<>"22" THEN LET X9$="<< Entry Type is not a Warehouse Entry >>"; GOSUB GENERROR; GOTO 3162
3173 GOTO 3180
3175 LET X9$="<< Original Ref. is not in Log Book File >>"; GOSUB GENERROR; GOSUB CLEAR_GLOBAL; GOTO 3163
3180 LET X0=22,X1=52,X3=1,X1$=M40$,X4=LEN(X1$),X=L3[3],GUI_ID=4005
3185 GOSUB GENINPUT
3188 IF Y$="U" THEN GOTO 3163
3190 LET L3[3]=X,T6$(50,5)=STR(X:M40$),T6$(45,5)=CVS(LL2$(115,8),1+2)
3191 IF LL0$=M0$ THEN GOTO 3200
3192 IF NUM(LL2$(115,8))=0 THEN LET X9$="<< Original Warehouse Entry has Zero Balance >>"; GOSUB GENERROR; GOSUB CLEAR_GLOBAL
3193 IF NUM(LL2$(115,8))<X THEN LET X9$="<< Withdrawl Quantity exceeds Original Warehouse Balance >>"; GOSUB GENERROR; GOSUB CLEAR_GLOBAL; GOTO 3180
3200 LET X0=22,X1=69,X3=0,X4=6,X$=L2$(53,6),WINDID$="IPLOG W1",GUI_ID=4010
3205 GOSUB GENINPUT; REM "CUSTOMER CODE"
3210 LET A$=STBL("DESTID2",ERR=3215),Y$="U"; LET DUMMY$=STBL("!CLEAR","DESTID2")
3215 IF Y$="U" THEN GOTO 3180
3220 LET X$=X$+FILL(6-LEN(X$))
3222 IF O2$(19,1)="1" AND FNE(X$) THEN LET X9$="<< Must enter Customer Code when using warehouse Link >>"; GOSUB GENERROR; GOTO 3200
3225 IF X$<>FILL(6) THEN READ (FILE[50],KEY=X$,DOM=3240)
3230 LET L2$(53,6)=X$
3235 IF GUI=0 THEN PRINT @(2,22),FILL(75) FI; GOTO 3245
3240 LET X9$="<< Code not in Customer File >>"; GOSUB GENERROR; GOTO 3200
3245 IF L3[3]=0 OR LL0$=M0$ OR NUM(LL2$(115,8))=0 THEN GOTO 3248
3246 LET LL2$(115,8)=STR(NUM(LL2$(115,8))-L3[3]); WRITE (FILE[13],KEY=LL0$)IOL=IPLGX_ALT
3248 GOSUB DESTROY_GUI_WINDOW; LET YDISABLE$=OLD_YDISABLE$; LET POP_WIND=0; RETURN
3250 REM ********************* READ DETAIL RECORDS OR CREATE THEM **********
3255 LET D1$=T0$+STR(I9:M1$)
3260 READ (FILE[3],KEY=D1$,DOM=3270)IOL=IPTR2X
3265 GOTO 3290
3270 DIM D2$(12),D3$(25),D4[3]
3275 IF W8$=FILL(6) THEN GOTO 3290
3280 READ (FILE[3],KEY=W8$+D1$(7,2),DOM=3290)IOL=IPTR2X
3285 LET D1$(1,6)=W9$
3290 RETURN 
3295 REM *********************** NEW ENTRY *********************************
3300 DIM T2$(73),T3$(194),T4$(160),T5$(176),T6$(55),T7$(60),L1$(150)
3305 LET X=0
3310 IF GUI THEN PRINT (OSGUI.CHAN)'SHOW'(1005,4005); GOTO 3320
3315 PRINT 'SB',@(2,22),"Copy From:",'SF'
3320 LET X0=22,X1=12,X3=1,X1$=M0$,X4=LEN(X1$),X=0,GUI_ID=4005
3325 GOSUB GENINPUT; REM  "COPY FROM"
3330 IF GUI=0 THEN PRINT @(2,22),FILL(25)
3335 IF Y$="U" THEN IF GUI THEN PRINT (OSGUI.CHAN)'HIDE'(1005,4005); EXITTO 1020 ELSE EXITTO 1020
3340 IF X$=FILL(6) THEN LET W8$=X$
3345 LET W8$=X$,W9$=T0$
3350 READ (FILE[2],KEY=W8$,DOM=3400)IOL=IPTR1X
3355 LET T0$=W9$
3360 LET T2$(1,7)=STR(JUL(0,0,0))
3365 LET T1$(1,9)=FILL(9)
3370 READ (FILE[13],KEY=T0$,DOM=3385)IOL=IPLGX
3375 LET WRITELOG=0
3380 GOTO 3390
3385 IF NO_NEW_O$="Y" THEN LET X9$="<< Documents have not been checked-in >>"; GOSUB GENERROR; EXITTO 1000
3390 IF GUI THEN PRINT (OSGUI.CHAN)'HIDE'(1005,4005)
3395 GOTO 3555
3400 REM ********************* GET LOG BOOK INFO ************
3405 IF GUI THEN PRINT (OSGUI.CHAN)'HIDE'(1005,4005)
3410 LET T2$(1,7)=STR(JUL(0,0,0)),WRITELOG=1; DIM L0$(6)
3412 IF ENTERED_IMPORTED$<>"I" AND T4$(21,49)=FILL(49) THEN LET T4$(21,49)=STBL("CNAME")
3415 IF CHL_NUMBER$<>"" THEN LET T3$(62,50)="CHL"+CHL_NUMBER$+" "+STBL("CNAME")
3420 READ (FILE[13],KEY=T0$,DOM=3550)IOL=IPLGX
3422 IF L1$(13,2)="21" OR L1$(13,2)="22" THEN LET X9$="<< Warehouse Entry Reference Type 21/22 was created in Log >>"; GOSUB GENERROR; GOSUB CLEAR_GLOBAL
3425 LET T4$(76,20)=L1$(87,12),T2$(32,13)=L1$(103,4),T2$(45,7)=STR(L4[3]),T3$(23,4)=L1$(103,4),T5$(21,18)=L1$(56,18),T5$(47,7)=STR(L4[1]),D4[1]=L3[1],D4[0]=L3[2],WRITELOG=0
3427 LET T5$(11,2)=L1$(99,2)
3430 LET CUST$=L2$(53,6)
3432 READ (FILE[6],KEY=L0$,DOM=3435)IOL=IPDFLX
3433 LET T5$(13,7)=I3$(186,7); REM EXPORT DATE
3435 IF DEF_CONSIGNEE$<>"Y" THEN GOTO 3460
3440 LET X$=CVS(L1$(26,30),2)+" "
3445 READ (FILE[50],KEY=L2$(53,6),DOM=3455)IOL=ARCUX
3450 LET X$=X$+CVS(C2$(1,30),2)+" "+CVS(C2$(31,30),2)
3455 LET T4$(96,65)=X$
3460 READ (FILE[43],KEY=L2$(62,4),DOM=3470,KNUM=0)IOL=IPCR
3465 LET T5$(88,20)=CY1$(43,4),T5$(39,8)=CY1$(59,2)
3470 IF ENTERED_IMPORTED$<>"I" THEN GOTO 3485
3475 READ (FILE[50],KEY=L2$(53,6),DOM=3485)IOL=ARCUX
3480 IF T4$(21,49)=FILL(49) THEN LET T4$(21,49)=C1$
3485 IF L1$(13,2)=FILL(2) THEN GOTO 3490 ELSE READ (FILE[91],KNUM=0,KEY=L1$(13,2),DOM=3490)IOL=AMIBTYPE 
3487 LET T2$(9,2)=L1$(13,2)
3490 LET MAWB$="",HAWB$="",IT_NUMB$=""
3495 READ (FILE[10],KNUM=0,KEY=L0$+"",DOM=3500)
3500 DIM AB1$(30)
3505 READ (FILE[10],END=3540)IOL=IPAWBX
3510 IF AB0$(1,6)<>L0$ THEN GOTO 3540
3515 IF AB1$(2,4)="MORE" THEN GOTO 3535
3520 IF AB1$(1,1)="M" AND MAWB$="" THEN LET MAWB$=AB1$(2,16)
3525 IF AB1$(1,1)="H" AND HAWB$="" THEN LET HAWB$=AB1$(2,12)
3530 IF AB1$(1,1)="I" AND IT_NUMB$="" THEN LET T2$(11,8)="I.T.",T2$(45,7)=STR(L4[2]),IT_NUMB$=AB1$(2,13)
3535 GOTO 3500
3536 IF GUI=0 THEN GOTO 3755
3540 LET T5$(108,16)=MAWB$,T5$(148,16)=HAWB$,T2$(19,13)=IT_NUMB$
3545 GOTO 3555
3550 IF NO_NEW_O$="Y" THEN LET X9$="<< Documents have not been checked-in >>"; GOSUB GENERROR; EXITTO 1000
3555 RETURN 
3560 REM ****************** CALCULATE TOTALS ********************
3565 DIM A1[3],D4[3]
3570 IF W8$<>FILL(6) THEN READ (FILE[3],KEY=W8$,DOM=3580); GOTO 3580
3575 READ (FILE[3],KEY=T0$,DOM=3580)
3580 READ (FILE[3],END=3600)IOL=IPTR2X
3585 IF D1$(1,6)<>T0$ THEN IF D1$(1,6)<>W8$ THEN GOTO 3600
3590 LET A1[ALL]=A1[ALL]+D4[ALL]
3595 GOTO 3580
3600 IF GUI=0 THEN GOTO 3615
3605 LET T_WEIGHT$=STR(A1[0]:M13$),T_VALUE$=STR(A1[1]:M14$),T_DUTY$=STR(A1[3]:M15$)
3610 PRINT (OSGUI.CHAN)'TITLE'(2010,T_WEIGHT$),'TITLE'(2020,T_VALUE$),'TITLE'(2030,T_DUTY$); GOTO 3620
3615 PRINT 'SF',@(39,17),A1[0]:M14$,@(50),A1[1]:M13$,@(65),A1[3]:M15$
3620 RETURN 
3625 REM ************** GET NEXT IN-BOND #
3630 IF DIV$="Y" THEN READ (FILE[9],KEY="BON"+T0$(1,1),DOM=3635)IOL=IPNUM; GOTO 3650
3635 READ (FILE[9],KEY="BOND",DOM=3645)IOL=IPNUM
3640 GOTO 3650
3645 LET X9$="<< Code 'BOND' not setup in Numbering Range >>"; GOSUB GENERROR; GOTO 3680
3650 LET N3=N3+1
3655 IF N3>N2 THEN LET X9$="<< WARNING: Reached end of range; Cannot generate NEW Number >>"; GOSUB GENERROR; GOTO 9990
3660 LET X$=STR(N3:"00000000")+STR(MOD(N3,7))
3665 WRITE (FILE[9])IOL=IPNUM
3670 IF GUI THEN PRINT (OSGUI.CHAN)'TITLE'(4030,X$) ELSE PRINT 'SF',@(X1,X0),X$
3675 IF N2-N3<250 THEN LET X9$="<< There are "+STR(N2-N3)+" In-Bond Numbers left >>"; GOSUB GENERROR
3680 RETURN 
3685 REM  SET VISITED **********
3690 SET_VISITED: 
3695 DIM VISITED$(0)
3700 LET VISITED$="IPTRNT:N(1),IPTRP1:N(1),IPNEXT:N(1),IPDLV:N(1),IPPRTA:N(1),IPBIL1:N(1),IPBIL2:N(1),IPSER:N(1),IPSCR:N(1),GENCKCR:N(1),IPBIZR:N(1)"
3705 DIM VISITED$:VISITED$
3710 DIM OSGUI_IPTRNT$:FATTR(OSGUI$); LET OSGUI_IPTRNT.CHAN=OSGUI.CHAN
3711 DIM OSGUI_IPTRNT1$:FATTR(OSGUI$); LET OSGUI_IPTRNT1.CHAN=OSGUI.CHAN
3712 DIM OSGUI_IPTRP1$:FATTR(OSGUI$); LET OSGUI_IPTRP1.CHAN=OSGUI.CHAN
3715 DIM OSGUI_IPNEXT$:FATTR(OSGUI$); LET OSGUI_IPNEXT.CHAN=OSGUI.CHAN
3716 DIM OSGUI_IPDLV$:FATTR(OSGUI$); LET OSGUI_IPDLV.CHAN=OSGUI.CHAN
3717 DIM OSGUI_IPPRTA$:FATTR(OSGUI$); LET OSGUI_IPPRTA.CHAN=OSGUI.CHAN
3718 DIM OSGUI_IPBIL1$:FATTR(OSGUI$); LET OSGUI_IPBIL1.CHAN=OSGUI.CHAN
3719 DIM OSGUI_IPBIL2$:FATTR(OSGUI$); LET OSGUI_IPBIL2.CHAN=OSGUI.CHAN
3720 DIM OSGUI_GENCKCR$:FATTR(OSGUI$); LET OSGUI_GENCKCR.CHAN=OSGUI.CHAN
3721 DIM OSGUI_IPSER$:FATTR(OSGUI$); LET OSGUI_IPSER.CHAN=OSGUI.CHAN
3722 DIM OSGUI_IPSCR$:FATTR(OSGUI$); LET OSGUI_IPSCR.CHAN=OSGUI.CHAN
3723 DIM OSGUI_IPBIZR$:FATTR(OSGUI$); LET OSGUI_IPBIZR.CHAN=OSGUI.CHAN
3725 DIM OSGUI_NEXTPROGRAM$:FATTR(OSGUI$); LET OSGUI_NEXTPROGRAM.CHAN=OSGUI.CHAN
3727 DIM OSGUI_GENDELIN$:FATTR(OSGUI$),OSGUI_GENCKCR$:FATTR(OSGUI$)
3728 LET OSGUI_GENDELIN.CHAN=OSGUI.CHAN,OSGUI_GENCKCR.CHAN=OSGUI.CHAN
3730 RETURN 
3735 RESET_WINDOW: 
3738 REM PRINT (OSGUI.CHAN)'HIDE'(0)
3740 PRINT (OSGUI.CHAN)'CONTEXT'(OSGUI.CUR_CONTEXT[1]); PRINT (OSGUI.CHAN)'ENABLE'(0),'FOCUS'(0); REM ***
3745 LET OSGUI.CONTEXT_POINTER=1
3750 IF Y$<>"P" THEN GOSUB CLEAR_GLOBAL
3755 RETURN 

3760 REM  ********* GET NEXT REFERENCE #
3765 LET CODE$="REF"+FILL(1)
3770 READ (FILE[9],KEY=CODE$,DOM=3780)IOL=IPNUM
3775 GOTO 3785
3780 LET X9$="<< Code '"+CODE$+"' not setup in Numbering Range >>"; GOSUB GENERROR; GOTO 3810
3785 LET N3=N3+1
3790 IF N3>N2 THEN LET N3=N1; LET X9$="<< WARNING: Reached end of range; Assumed starting # >>"; GOSUB GENERROR
3795 LET X$=STR(N3:"000000")
3800 WRITE (FILE[9])IOL=IPNUM
3805 IF GUI THEN PRINT (OSGUI.CHAN)'TITLE'(4030,X$) ELSE PRINT 'SF',@(X1,X0),X$
3810 RETURN 
3815 REM **************** JAF SPECIAL LOG ***************
3820 JAF_AWB_LOG: 
3825 IF POS(D3$(1,1)="MH")=0 OR NUM(D2$,ERR=3905)=0 THEN GOTO 3905
3830 LET X$=""; REM CLEAN HOUSE OFF DASHES
3835 FOR I=6 TO 25
3840 IF D3$(I,1)<>"-" THEN LET X$=X$+D3$(I,1)
3845 NEXT I
3850 IF LEN(X$)<12 THEN LET X$=X$+FILL(12-LEN(X$))
3855 LET M$=""; REM CLEAN MASTER OFF DASHES
3860 FOR I=108 TO 123
3865 IF T5$(I,1)<>"-" THEN LET M$=M$+T5$(I,1)
3870 NEXT I
3875 IF LEN(M$)<11 THEN LET M$=M$+FILL(11-LEN(M$))
3880 IF D3$(1,1)="M" THEN LET AWB$=X$(1,11) ELSE LET AWB$=M$(1,11)+X$(1,12)
3885 IF CY0$<>FILL(4) THEN LET CARRIER$=CY0$ ELSE LET CARRIER$=L2$(62,2)
3890 IF C0$<>FILL(6) THEN LET CUST$=C0$ ELSE LET CUST$=L2$(53,6)
3895 LET FLIGHT$=T3$(12,5)
3900 CALL "IPJASAWB",AWB$,NUM(D2$),CARRIER$,CUST$,FLIGHT$,T1$(1,9),NUM(T2$(1,7))
3905 RETURN 
3990 UPDATE_IPTR2X_COPYFROM: 
4005 IF W8$=FILL(6) THEN GOTO 4100
4010 FOR II=1 TO MAXLINE
4015 READ (FILE[3],KEY=W8$+STR(II:"00"),DOM=4078)IOL=IPTR2X
4050 LET ALT_D1$=T0$+D1$(7,2)
4060 LET ALT_D2$=D2$,ALT_D3$=D3$,ALT_D4[0]=D4[0],ALT_D4[1]=D4[1],ALT_D4[2]=D4[2],ALT_D4[3]=D4[3]
4070 WRITE (FILE[3],KEY=AL_D1$)IOL=IPTR2X_ALT
4075 GOTO 4080
4078 EXITTO 4100
4080 NEXT II
4100 RETURN 
4800 RESET_WINDOW2: 
4805 IF GUI=0 THEN GOTO 4840
4810 PRINT (OSGUI.CHAN)'CONTEXT'(OSGUI.CUR_CONTEXT[2])
4820 LET OSGUI.CONTEXT_POINTER=2
4830 IF Y$<>"P" THEN GOSUB CLEAR_GLOBAL
4840 RETURN
5800 REM 5800 ***** ENTER PEDIMENTO NUMBER CLASS TYPE '63' FOR MEXICO *****
5805 PEDIMENTO: 
5810 LET X0=5,X1=51,X3=0,X4=15,X$=T7$(15,15),GUI_ID=4057
5815 LET X8$="<< WARNING: Enter Pedimento #, if cargo destined for Mexico >>"; GOSUB GENERROR
5820 GOSUB GENINPUT; REM PEDIMENTO #
5825 LET X8$=" "; GOSUB GENERROR
5830 IF Y$="U" THEN EXITTO 1290
5840 REM IF FNE(X$) THEN LET X9$="<< WARNING: Enter Pedimento #, if cargo destined for Mexico >>"; GOSUB CLEAR_GLOBAL; GOSUB GENERROR
5850 LET T7$(15,15)=X$
5890 RETURN 
6000 REM 0 - (GENINPUT) 6000-6190
6001 GENINPUT: REM "08/05/92 - General Input Routine Interface"
6005 LET WIND$=WINDID$,SEL$=SELVAL$,PRO$=PROGID$
6010 IF X9<>0 THEN GOTO 6100
6090 IF POS(Y$="PQ") THEN LET WINDID$="",SELVAL$="",PROGID$=""; RETURN 
6100 IF GUI=0 THEN CALL "GENINPUT.PUB",ERR=GENERROR,Z9$,Y$,(X0),(X1),(X2),(X3),(X4),X9,X1$(1),X,X$,INFO,WINDID$,SELVAL$,COMPID$,PROGID$,FILE[ALL],YDISABLE$,PGM(-2),FLD_HLP$; GOTO 6120
6110 CALL "GENGUINP.PUB",ERR=GENERROR,Z9$,Y$,(X0),(X1),(X2),(X3),(X4),X9,X1$(1),X,X$,INFO,WINDID$,SELVAL$,COMPID$,PROGID$,FILE[ALL],YDISABLE$,PGM(-2),FLD_HLP$,GUI_ID,BUTTON_KEYS$[ALL],OSGUI$,GUI_RADIO$
6120 ON POS(Y$="DQI PJCEU") GOTO 6180,6185,11000,6183,6190
6180 IF STBL("VERSW")="OFF" THEN GOSUB 8420 ELSE GOSUB 8410; REM "check other commands"
6182 GOTO 6100
6183 GOSUB INFO; LET Y$="E",WINDID$=WIND$,SELVAL$=SEL$,PROGID$=PRO$; GOTO 6100
6185 GOSUB 9200
6187 GOTO 6100
6190 RETURN
6200 INFO:
6210 RETURN 
6500 NEXT_PROGRAM_TO_RUN:
6505 NEXTPROGRAM$="IPTRNT";OSGUI_NEXTPROGRAM$=OSGUI$;VISITED_ONE=0
6506 IF GUI THEN OSGUI_IPTRNT$=OSGUI$; OSGUI_IPTRNT.CONTEXT_POINTER=OSGUI.CONTEXT_POINTER
6508 CALL "IPNEXT"
6510 IF GUI THEN LET OSGUI$=OSGUI_IPTRNT$; OSGUI.CONTEXT_POINTER=OSGUI_IPTRNT.CONTEXT_POINTER
6515 GOSUB RESET_WINDOW2
6520 IF XN1$="N" AND XN2$="N" AND XN3$="N" THEN GOTO 6665
6610 IF XN3$="N" GOTO 6640
6620 IF NEXT_PGM$[NEXT_TO_RUN]<>"IPBIL1" GOTO 6640
6625 PRINT (OSGUI.CHAN)'DESTROY'(0)
6630 IF BARISTA_IND$="Y" CK_ID=9990; GOSUB OPEN_BARISTA_FORM;NEXT_TO_RUN=NEXT_TO_RUN+1;LET OSGUI$=NEXT_OSGUI$[NEXT_TO_RUN]
6640 IF XN2$="N" GOTO 6665
6650 LET OSGUI$=NEXT_OSGUI$[NEXT_TO_RUN]
6660 RUN NEXT_PGM$[NEXT_TO_RUN]
6665 IF PREALERT_REF$="" OR LEN(PREALERT_REF$)=0 THEN GOTO 6680 ELSE IF GUI THEN LET OSGUI$=OSGUI_IPNEXT$ ELSE IF GUI THEN LET OSGUI_IPTRNT$=OSGUI$; PRINT (OSGUI.CHAN)'HIDE'(0)
6672 FOR I=1 TO NUM(STBL("CHANNELS"))
6674 CLOSE (FILE[I],ERR=6675)
6675 LET FILE[I]=0
6676 NEXT I
6677 RUN "IPPACI1"
6680 LET WHERE_VAR=0
6685 VISITED_ONE=0
6688 IF GUI THEN LET OSGUI$=OSGUI_IPTRNT$;OSGUI.CONTEXT_POINTER=OSGUI_IPTRNT.CONTEXT_POINTER
6690 GOSUB RESET_WINDOW2
6695 RUN "IPTRNT"
6700 RETURN
7500 PROMPTS: 
7501 REM ********************* Display Screen *****************************
7502 IF GUI THEN GOTO GUI_PROMPTS
7503 GOSUB BOX
7504 PRINT 'SB',STBL("FTXT"),
7505 IF SCREEN=2 THEN GOTO PROMPTS2
7510 PRINT @(2,1),"Ref.#",@(29),"Entry #",@(58),"Entry #"
7515 IF O2$(19,1)="1" THEN PRINT @(2,3),"Customer"
7520 PRINT @(20,2),"Port",@(58),"Class"
7530 PRINT @(20,3),"Date",@(58),"IBECC"
7540 PRINT @(2,5),"Log #"
7545 IF VESSEL_FTZ$="Y" THEN PRINT @(46,5),"CASR",@(17,17),"Drayed by"
7550 PRINT @(2,6),"Dist #",@(14),"Port Code #",@(31),"1st US Port of Unlading"
7560 PRINT @(2,7),"Port of",@(31),"Date",@(50),"G.O. No."
7570 PRINT @(2,9),"Entered or Imported by"
7580 PRINT @(2,10),"in bond via"
7590 PRINT @(2,12),"Customs",@(31),"Final foreign destination"
7600 PRINT @(2,13),"Consignee"
7610 PRINT @(2,14),"Foreign port of lading",@(48),"B/L #"
7620 PRINT @(2,15),"Sailing",@(48),"House #"
7630 PRINT @(2,16),"Imported on the",@(39),"Flag",@(55),"on"
7640 PRINT @(2,17),"Via"
7650 PRINT @(2,18),"Exported from",@(34),"on",@(48),"Goods at"
7652 PRINT @(2,19),"Carrier",@(48),"Seal #",@(66),"Operator"
7654 IF STBL("SOFTWARE")="ASCI" THEN IF (O1$="RMMENU" OR O1$="AMMENU") AND MENU_OSGUI$<>"" THEN CALL "GENGUPR.PUB::HIDE_MENU",ERR=7699,MENU_OSGUI$,OSGUI$; LET OSGUI$=""; LET MENU_OSGUI$="" ELSE GOTO 7699 ELSE IF O1$="RMMENU2" AND MENU_OSGUI$<>"" THEN CALL "GENGUPR.PUB::HIDE_MENU",ERR=7699,MENU_OSGUI$,OSGUI$; LET OSGUI$=""; LET MENU_OSGUI$=""
7655 RETURN 
7660 PROMPTS2: 
7661 REM **************** Display Second Screen ******************************
7670 PRINT @(2,1),"Ref.#"
7671 IF O2$(19,1)="1" THEN PRINT @(34,1),"Whse Release by"
7672 PRINT @(2,2),"Mark/Number",@(15),"Description and Quantity",@(41),"Weight",@(48),"L/K",@(53),"Value",@(61),"Rate",@(70),"Duty"
7673 PRINT @(30,17),"Totals:"
7680 PRINT @(2,19),"AWB #",@(34),"Charges",@(59),"Manifest #"
7684 PRINT @(2,20),"Operator",@(34),"Bond",@(59),"Port"
7699 RETURN 
7700 DATA: 
7701 REM *********************** Display Data ********************************
7702 IF GUI THEN GOTO GUI_DATA
7703 PRINT 'CF','SF',STBL("FTXT"),
7705 IF SCREEN=2 THEN GOTO DATA2
7707 IF VESSEL_FTZ$<>"Y" THEN PRINT @(39,5),FILL(27)
7710 PRINT @(8,1),T0$,@(20),T2$(11,8),@(37),T2$(19,13),@(66),T1$
7720 PRINT @(25,2),T2$(32,13),@(64),T2$(9,2); REM ,@(67),CLASS7$(POS(T2$(9,2)=CLASS7$,12)+2,10)
7730 IF NUM(T2$(45,7))>0 THEN LET X$=FND$(NUM(T2$(45,7))) ELSE LET X$=FILL(8)
7740 PRINT @(25,3),X$,@(64),T2$(8,1)
7750 PRINT @(9,5),T3$(1,11),@(24),T3$(12,11)
7755 IF VESSEL_FTZ$="Y" THEN PRINT @(51,5),T5$(20,1),@(28,17),T7$(15,45)
7757 IF T2$(9,2)="63" AND VESSEL_FTZ$<>"Y" THEN PRINT 'SB',@(39,5),"Pedimento #",'SF',@(51,5),T7$(15,15)
7760 PRINT @(9,6),T3$(23,2),@(26),T3$(25,2),@(57),T2$(53,16)
7762 DIM R21$(40),R22$(150)
7764 READ (FILE[65],KEY=T3$(23,4),DOM=7770)IOL=IPCNT2
7770 IF NUM(T2$(1,7))>0 THEN LET X$=FND$(NUM(T2$(1,7))) ELSE LET X$=FILL(8)
7775 PRINT @(10,7),R22$(1,13),@(36),X$,@(59),T5$(164,12)
7780 PRINT @(25,9),T4$(21,49)
7790 PRINT @(14,10),T3$(62,50)+T7$(2,13)
7795 PRINT @(14,11),T3$(132,63)
7800 PRINT @(10,12),T3$(112,20),@(57),T4$(1,20)
7805 PRINT @(12,13),T4$(96,65)
7810 PRINT @(25,14),T4$(76,20),@(54),T5$(108,16)
7812 IF NUM(T5$(13,7))>0 THEN LET X$=FND$(NUM(T5$(13,7))) ELSE LET X$=FILL(8)
7814 PRINT @(11,15),X$,@(56),T5$(148,16)
7816 IF NUM(T5$(47,7))>0 THEN LET X$=FND$(NUM(T5$(47,7))) ELSE LET X$=FILL(8)
7818 PRINT @(18,16),T5$(21,18),@(44),T5$(39,8),@(58),X$
7819 PRINT @(6,17),T5$(55,10)
7820 IF NUM(T5$(80,7))>0 THEN LET X$=FND$(NUM(T5$(80,7))) ELSE LET X$=FILL(8)
7822 PRINT @(16,18),T5$(65,15),@(37),X$,@(57),T5$(88,20)
7823 IF GUI THEN GOTO 7828
7824 PRINT @(10,19),T3$(27,35),@(55),T5$(124,10),@(75),T5$(11,2)
7825 IF POS(T2$(9,2)="333536376263",2)>0 THEN PRINT 'SB',@(2,20),"Bond Amt",@(21),"Withdrawal Amt",@(48),"Balance",'SF',@(11),T6$(45,5),@(36),T6$(50,5),@(55),NUM(T6$(45,5))-NUM(T6$(50,5)):M6$
7828 RETURN 
7830 DATA2: 
7831 REM ***************** Display Data for 2nd Screen *******************
7832 IF GUI THEN GOTO GUI_DATA1
7833 PRINT 'CF','SF',STBL("FTXT"),
7835 PRINT @(8,1),T0$
7842 PRINT @(8,19),T6$(1,12),@(42),T6$(13,6),@(70),T6$(19,6)
7844 PRINT @(11,20),T6$(25,20),@(39),T5$(1,10),@(64),T5$(144,4)
7845 IF W8$<>FILL(6) THEN READ (FILE[3],KEY=W8$,DOM=7850); GOTO 7850
7846 READ (FILE[3],KEY=T0$,DOM=7850)
7850 FOR I=1 TO 13
7860 READ (FILE[3],END=7876)IOL=IPTR2X
7862 IF D1$(1,6)<>T0$ THEN IF D1$(1,6)<>W8$ THEN GOTO 7876
7865 IF D4[2]>0 THEN LET X1$=STR(D4[2]:M2$) ELSE LET X1$=FILL(LEN(M2$))
7866 IF D4[3]>0 THEN LET X2$=STR(D4[3]:M5$) ELSE LET X2$=FILL(LEN(M5$))
7870 PRINT @(2,I+3),D2$,@(15),D3$,@(41),D4[0]:M4$,@(51),D4[1]:M3$,@(59),X1$,@(67),X2$
7874 GOTO 7878
7876 EXITTO 7880
7878 NEXT I
7880 GOSUB 3560
7899 RETURN 
7900 REM 0 - (DISBOX) 7900-7995
7901 BOX: REM "DISPLAY BOX"
7902 PRINT 'CS','SB',STBL("FBX"),
7905 PRINT 'BACKGR',STBL("FBKG"),STBL("FBX"),'DEFAULT','CS','SB',
7910 PRINT 'BOX'(0,0,79,24),'GS',
7915 IF SCREEN=2 THEN PRINT @(0,3),"6",'BOX'(1,3,77,0),@(78,3),"7",@(0,18),"6",'BOX'(1,18,77,0),@(78,18),"7"; GOTO 7980
7920 PRINT @(0,4),"6",'BOX'(1,4,77,0),@(78,4),"7"
7925 PRINT @(18,0),"9",'BOX'(18,1,0,3),@(18,4),"8"
7930 PRINT @(56,0),"9",'BOX'(56,1,0,3),@(56,4),"8"
7940 PRINT @(0,8),"6",'BOX'(1,8,77,0),@(78,8),"7"
7980 PRINT @(0,21),"6",'BOX'(1,21,77,0),@(78,21),"7",'GE',
7985 PRINT 'SB',STBL("FTTL"),@(INT((79-LEN(TITLE$))/2),0),TITLE$,
7995 RETURN 
8300 REM 0 - (GENOPEN) 8300-8320
8301 GENOPEN: REM "03/21/95 General file OPEN routine"
8305 LET GENOPEN_MSG$="",YSAVE$=YDISABLE$,YDISABLE$="XSJPUD",Y$=""
8310 CALL "GENOPEN.PUB",FILE[ALL],F$,F0,TASK,TPL$,GENOPEN_MSG$,Y$
8311 IF Y$="M" THEN GOTO 9990
8312 IF POS("Unavailable"=GENOPEN_MSG$) THEN LET X9$=GENOPEN_MSG$; GOSUB GENERROR; GOTO 8305
8315 IF GENOPEN_MSG$<>"" THEN LET O7=1,X9$=GENOPEN_MSG$; GOSUB GENERROR; GOTO 9990
8320 LET YDISABLE$=YSAVE$,YSAVE$=""; RETURN 
8400 REM 0 - (GENERROR) 8400-8452
8401 GENERROR: REM "02/21/89 - GENERAL ERROR ROUTINE"
8405 IF O7=0 AND X9$="" AND X8$="" THEN LET O7=-3
8410 CALL "GENERROR.PUB",X9$,X8$,ERR,TCB(5),O7,Y$,TCB(10),X1$(1),F$(1),PROGID$,FILE[ALL],YDISABLE$,PGM(-2),X$,X4,MX8,MX9,OSGUI$
8420 ON POS(Y$="XMSLR") GOTO 8450,8452,9990,8452,8490,8499
8450 RETURN 
8452 LET SPREC=TCB(14); RESET; PRECISION SPREC; SETERR GENERROR
8454 IF Y$="X" THEN GOTO 8470
8456 IF Y$="S" THEN GOTO 8480
8470 IF POP_WIND THEN LET POP_WIND=0; LET YDISABLE$=""; IF GUI THEN GOSUB DESTROY_GUI_WINDOW; GOSUB CLEAR_GLOBAL FI; GOTO 1145
8471 IF SCREEN=2 THEN LET SCREEN=1; LET YDISABLE$=""; GOSUB PROMPTS
8472 IF GUI THEN PRINT (OSGUI.CHAN)'HIDE'(1005,4005)
8475 GOTO 1000
8485 IF SCREEN=1 THEN ON P0CHK GOTO 1000,1145 ELSE GOTO 2470
8490 REM 0 - (GENERROR2) 8490-8499
8491 CALL "GENPSCR.PUB"
8495 RETURN 
8499 RETRY
9200 REM 0 - (DELETE) 9200-9299
9210 LET O7=3; GOSUB GENERROR
9215 IF Y$<>"D" THEN RETURN 
9218 LET WIDTHDR_QTY=0
9220 REMOVE (FILE[2],KEY=T0$,DOM=9230)
9230 READ (FILE[3],KEY=T0$,DOM=9240)
9240 READ (FILE[3],END=9260)D1$
9250 IF D1$(1,6)=T0$ THEN REMOVE (FILE[3],KEY=D1$); GOTO 9240
9252 READ (FILE[13],KEY=T0$,DOM=9260)IOL=IPLGX
9253 LET WIDTHDR_QTY=L3[3]
9254 REMOVE (FILE[13],KEY=T0$)
9255 READ (FILE[13],KEY=T5$(134,6),DOM=9260)IOL=IPLGX
9257 LET L2$(115,8)=STR(NUM(L2$(115,8))+WIDTHDR_QTY)
9258 WRITE (FILE[13])IOL=IPLGX
9260 LET SCREEEN=1
9270 GOSUB PROMPTS
9290 LET Y$="X"
9299 GOTO 8452
9990 REM 0 - (ENDPGM) 9990-9999
9991 QUIT: 
9992 IF POP_WIND THEN LET POP_WIND=0; IF GUI THEN GOSUB DESTROY_GUI_WINDOW; GOSUB CLEAR_GLOBAL FI; LET YDISABLE$=""; GOTO 2395
9995 IF BARISTA_IND$="Y" THEN RELEASE ELSE RUN O1$; REM "RETURN TO MENU"
9999 END
10000 REM 0 - (GENNUM) 10000-10099
10002 DEF FNNUM$(XX,XX1$)
10003 LET XX$=STR(XX:XX1$,ERR=10005); GOTO 10006
10005 LET XX1=LEN(XX1$); IF POS(XX1$(XX1,1)="-)") THEN LET XX1=XX1-1 FI; LET XX$=FILL(XX1,"*"),XX$=XX$+FILL(LEN(XX1$)-LEN(XX$))
10006 RETURN XX$
10008 FNEND
10010 DEF FNGUINUM$(XX,XX1$,ID)
10015 LET XX$=STR(XX:XX1$,ERR=10020); GOTO 10025
10020 LET XX1=LEN(XX1$); IF POS(XX1$(XX1,1)="-)") THEN LET XX1=XX1-1 FI; LET XX$=FILL(XX1,"*"),XX$=XX$+FILL(LEN(XX1$)-LEN(XX$))
10025 LET TF$=SENDMSG(OSGUI.CHAN,ID,23,0,XX1$)
10030 RETURN CVS(XX$,3)
10035 FNEND
11000 QUICK_PRINT: 
11010 IF QP_OPT$<>"Y" THEN GOTO 6090
11020 LET LAST_X0=X0,LAST_X1=X1,LAST_X2=X2,LAST_X3=X3,LAST_X4=X4,LAST_X$=X$,LAST_X=X
11030 LAST_WINDID$=WINDID$,LAST_PROGID$=PROGID$,LAST_SELVAL$=SELVAL$,LAST_X1$=X1$
11040 IF QP=0 THEN LET X9$="<< Must complete data input before printing form >>"; GOSUB GENERROR; RETURN 
11050 IF ! GUI THEN GOTO 11090
11060 O7=10,X9$="Print 7512 Form ?"; LET X$="Y"; GOSUB GENERROR
11070 IF Y$="E" OR Y$="P" THEN LET X$="Q" ELSE LET X$="N" FI; LET Y$=""
11080 GOTO 11160
11090 PRINT 'SB',@(2,22),FILL(70),@(2,22),"Print 7512 Form?",'SF'
11100 LET PRINT_FORM$="Y",Y$=""
11110 LET X0=22,X1=29,X3=5,X1$="YN",X4=1,X$=PRINT_FORM$
11120 GOSUB GENINPUT
11130 LET X8$=" "; GOSUB GENERROR
11140 IF Y$="U" THEN GOTO 11240
11150 LET X$=X$+FILL(X4-LEN(X$))
11155 IF X$="Y" THEN LET X$="Q"
11160 IF X$<>"Q" THEN GOTO 11240
11170 LET QP_RCD$=T0$,QP_RETURN$=PGM(-2); IF GUI THEN QP_OSGUI$=OSGUI$,QP_CONTEXT_POINTER=OSGUI.CONTEXT_POINTER
11180 LET WHERE_VAR=0,WHERETO=0
11190 IF BARISTA_IND$<>"Y" THEN GOTO 11240
11200 A$=STBL("QP_MAIN_PGM","IPTRNT")
11210 OSGUI_IPTRNT$=OSGUI$,REF_NO$=T0$
11220 APPL_PGM$="IPTRNT",REF_NUMBER$=T0$;CK_ID=9900;GOSUB OPEN_BARISTA_FORM;QP_RCD$=""
11230 OSGUI$=OSGUI_IPTRNT$;PREV_PGM$="IPTRNT"
11240 LET X0=LAST_X0,X1=LAST_X1,X2=LAST_X2,X3=LAST_X3,X4=LAST_X4,X$=LAST_X$,X=LAST_X
11250 WINDID$=LAST_WINDID$,PROGID$=LAST_PROGID$,SELVAL$=LAST_SELVAL$,X1$=LAST_X1$
11260 IF Y$="Q" THEN GOTO 6090 ELSE RETURN 
15240 REM ************************************************************************
15250 REM * Link between bbj programs and Barista forms                          *
15260 REM ************************************************************************
16000 OPEN_BARISTA_FORM:
16010 IF GUI=0 GOTO 16200
16040 MAIN_OSGUI$=OSGUI$
16050 PF$=STR(PFX)
16060 IP_DIR$=STBL("IPDIR")
16062 ORIG_OSGUI_SCALE=OSGUI.SCALE
16065 PRINT (OSGUI.CHAN)'SCALE'(1,1); LET FONTSIZE=-1,OSGUI.SCALE=1
16070 CALL STBL("RMDIR")+"RMBAROF",PGM(-1),CK_ID,T0$(1,6),1,FILL(1)
16075 PRINT (1)'DESTROY'(0)
16080 PREFIX PF$
16090 CHDIR IP_DIR$
16100 OSGUI$=OSGUI_IPTRNT$; IF GUI THEN GOSUB RESET_WINDOW                                           
16190 Y$=""
16200 RETURN
17505 GUI_PROMPTS: 
17515 LET OSGUI.SCRNID$="IPTRNT.ARC",OSGUI.WIND_ID[1]=1,OSGUI.WIND_ID[3]=3,OSGUI.CONTEXT_POINTER=-1
17518 LET VISITED_ONE=1,SAVE_CONTEXT=OSGUI.CONTEXT_POINTER
17520 LET MSG$=""; CALL "GENGURES.PUB",FILE[ALL],OSGUI$,MSG$; IF CVS(MSG$,3)<>"" THEN LET X9$=MSG$,O7=1; GOSUB GENERROR; GOTO QUIT
17523 LET OSGUI.CONTEXT_POINTER=1
17525 CALL "GENGUFNC.PUB::BUILD_MENU_STRINGS",MENUHLP$,MENU1$
17530 CALL "GENGUFNC.PUB::BUILD_HLE_MENU",MENUHLE$
17538 LET MENU2$=MENU1$+MENUHLE$+MENUHLP$; PRINT (OSGUI.CHAN)'CONTEXT'(OSGUI.CUR_CONTEXT[2]),'SETMENU',MENU2$
17540 LET MENU2$=MENU1$+MENUHLP$; PRINT (OSGUI.CHAN)'CONTEXT'(OSGUI.CUR_CONTEXT[3]),'SETMENU',MENU2$; PRINT (OSGUI.CHAN)'CONTEXT'(OSGUI.CUR_CONTEXT[1]),'SETMENU',MENU2$; PRINT (OSGUI.CHAN)'CONTEXT'(OSGUI.CUR_CONTEXT[1]); LET MENU1$="",MENUHLP$="",MENUHLE$=""
17545 IF BARISTA_IND$="Y" PRINT (OSGUI.CHAN)'MOVE'(0,0,0)
17552 PRINT (OSGUI.CHAN)'SHOW'(0); GOSUB DISABLE_FIELDS; PRINT (OSGUI.CHAN)'TITLE'(0,TITLE$); LET OSGUI.CONTEXT_POINTER=1
17553 IF PREV_PGM$="IPTRNT" THEN CALL "GENGUPR.PUB::NEXT_PREV_GUI_PGM",OSGUI_IPTRNT$,OSGUI$,OSGUI_IPTRNT.CONTEXT_POINTER,OSGUI.CONTEXT_POINTER
17554 IF PREV_PGM$="IPTRP1.RAN" THEN CALL "GENGUPR.PUB::NEXT_PREV_GUI_PGM",OSGUI_IPTRP1$,OSGUI$,OSGUI_IPTRP1.CONTEXT_POINTER,OSGUI.CONTEXT_POINTER; LET PREV_PGM$=""; GOTO 17563
17555 IF PREV_PGM$="IPTRP1.AP2" THEN CALL "GENGUPR.PUB::NEXT_PREV_GUI_PGM",OSGUI_IPTRP1$,OSGUI$,OSGUI_IPTRP1.CONTEXT_POINTER,OSGUI.CONTEXT_POINTER; LET PREV_PGM$=""; GOTO 17563
17556 IF PREV_PGM$="IPTRP1" THEN CALL "GENGUPR.PUB::NEXT_PREV_GUI_PGM",OSGUI_IPTRP1$,OSGUI$,OSGUI_IPTRP1.CONTEXT_POINTER,OSGUI.CONTEXT_POINTER; LET PREV_PGM$=""; GOTO 17563
17557 IF PREV_PGM$="IPTRP1.598" THEN CALL "GENGUPR.PUB::NEXT_PREV_GUI_PGM",OSGUI_IPTRP1$,OSGUI$,OSGUI_IPTRP1.CONTEXT_POINTER,OSGUI.CONTEXT_POINTER; LET PREV_PGM$=""; GOTO 17563
17558 IF PREV_PGM$="IPDLV" THEN CALL "GENGUPR.PUB::NEXT_PREV_GUI_PGM",OSGUI_IPDLV$,OSGUI$,OSGUI_IPDLV.CONTEXT_POINTER,OSGUI.CONTEXT_POINTER; LET PREV_PGM$=""; GOTO 17563
17560 IF STBL("GUIMENU")<>"ON" THEN GOTO 17562
17561 IF STBL("SOFTWARE")="ASCI" THEN IF (O1$="RMMENU" OR O1$="AMMENU") THEN CALL "GENGUPR.PUB::HIDE_MENU",ERR=17562,MENU_OSGUI$,OSGUI$ ELSE GOTO 17562 ELSE IF O1$="RMMENU2" THEN CALL "GENGUPR.PUB::HIDE_MENU",ERR=17562,MENU_OSGUI$,OSGUI$
17562 IF PREALERT_REF$="" OR LEN(PREALERT_REF$)=0 THEN LET OSGUI_IPTRNT$=OSGUI$,OSGUI_IPTRNT.CONTEXT_POINTER=OSGUI.CONTEXT_POINTER,PREV_PGM$="IPTRNT"
17563 PREV_PGM$="IPTRNT"
17564 RETURN 
17565 GUI_PROMPTS1: 
17568 REM IF VISITED_TWO=1 THEN PRINT (OSGUI.CHAN)'CONTEXT'(OSGUI.CUR_CONTEXT[2]); LET OSGUI.CONTEXT_POINTER=2; GOTO 17576
17569 LET VISITED_TWO=1,SAVE_CONTEXT=OSGUI.CONTEXT_POINTER
17570 LET OSGUI.SCRNID$="IPTRNT.ARC",OSGUI.WIND_ID[2]=2,OSGUI.CONTEXT_POINTER=2
17571 LET OSGUI.TOOL_CONTEXT[2]=1,OSGUI.BASE_CONTEXT[2]=1
17573 LET MSG$=""; CALL "GENGURES.PUB",FILE[ALL],OSGUI$,MSG$; IF CVS(MSG$,3)<>"" THEN LET X9$=MSG$,O7=1; GOSUB GENERROR; GOTO QUIT
17574 CALL "GENGUFNC.PUB::BUILD_MENU_STRINGS",MENUHLP$,MENU1$
17575 CALL "GENGUFNA.PUB::BUILD_QUICK_PRT_MENU_STRINGS",MENUA$
17576 LET MENU1$=MENU1$+MENUA$+MENUHLP$; PRINT (OSGUI.CHAN)'SETMENU',MENU1$; LET MENU1$="",MENUHLP$="",MENUA$=""; IF BARISTA_IND$="Y" PRINT (OSGUI.CHAN)'MOVE'(0,0,0)
17577 PRINT (OSGUI.CHAN)'SHOW'(0); LET OSGUI.CONTEXT_POINTER=2
17578 IF PREV_PGM$="IPTRNT" THEN CALL "GENGUPR.PUB::NEXT_PREV_GUI_PGM",OSGUI_IPTRNT$,OSGUI$,OSGUI_IPTRNT.CONTEXT_POINTER,OSGUI.CONTEXT_POINTER
17579 IF PREALERT_REF$="" OR LEN(PREALERT_REF$)=0 THEN LET OSGUI_IPTRNT$=OSGUI$,OSGUI_IPTRNT.CONTEXT_POINTER=OSGUI.CONTEXT_POINTER,PREV_PGM$="IPTRNT"
17580 RETURN 
17600 GUI_PROMPTS2: REM *** THIS IS THE WINDOW TO SELECT ENT TYPE 21 TO GET PCS ***
17602 LET SAVE_CONTEXT=OSGUI.CONTEXT_POINTER; REM This context could be 1 or 2 depending which screen is calling the routine ***
17605 REM IF VISITED_THREE=1 THEN PRINT (OSGUI.CHAN)'CONTEXT'(OSGUI.CUR_CONTEXT[3]); LET OSGUI.CONTEXT_POINTER=3; GOTO 17650
17608 LET VISITED_THREE=1,SAVE_CONTEXT=OSGUI.CONTEXT_POINTER
17610 LET OSGUI.SCRNID$="IPTRNT.ARC",OSGUI.WIND_ID[3]=3,OSGUI.CONTEXT_POINTER=3
17620 LET OSGUI.TOOL_CONTEXT[3]=-1,OSGUI.BASE_CONTEXT[3]=-1
17630 LET MSG$=""; CALL "GENGURES.PUB",FILE[ALL],OSGUI$,MSG$; IF CVS(MSG$,3)<>"" THEN LET X9$=MSG$,O7=1; GOSUB GENERROR; GOTO QUIT
17640 CALL "GENGUFNC.PUB::BUILD_MENU_STRINGS",MENUHLP$,MENU1$
17650 LET MENU1$=MENU1$+MENUHLP$; PRINT (OSGUI.CHAN)'SETMENU',MENU1$; LET MENU1$="",MENUHLP$=""
17660 PRINT (OSGUI.CHAN)'SHOW'(0); LET VISITED_THREE=1
17670 RETURN 
17700 REM 17700,5 "----- GUI Data"
17705 GUI_DATA: 
17707 IF VESSEL_FTZ$<>"Y" THEN PRINT (OSGUI.CHAN)'CLRTITLE'(1080,4057),'HIDE'(4057)
17708 IF T2$(9,2)="63" AND VESSEL_FTZ$<>"Y" THEN PRINT (OSGUI.CHAN)'ENABLE'(4057),'TITLE'(1080,"Pedimento #"),'TITLE'(4057,T7$(15,15)),'SHOW'(1080,4057)
17710 IF VESSEL_FTZ$="Y" THEN PRINT (OSGUI.CHAN)'SHOW'(1080,1370,4055,4225)
17715 PRINT (OSGUI.CHAN)'TITLE'(2010,FILL(10)),'TITLE'(2020,R22$(1,13)),'TITLE'(2040,BALANCE$)
17720 PRINT (OSGUI.CHAN)'TITLE'(4000,T0$)
17725 PRINT (OSGUI.CHAN)'TITLE'(4010,T2$(11,8))
17730 PRINT (OSGUI.CHAN)'TITLE'(4015,T2$(19,13))
17735 PRINT (OSGUI.CHAN)'TITLE'(4020,T2$(32,13))
17740 IF NUM(T2$(45,7))>0 THEN LET X=NUM(T2$(45,7)) ELSE LET X=-1
17745 PRINT (OSGUI.CHAN)'TITLE'(4025,FND$(X))
17750 PRINT (OSGUI.CHAN)'TITLE'(4030,T1$)
17752 LET S=FNLIST(4040,T2$(8,1),"YN",1)
17755 PRINT (OSGUI.CHAN)'TITLE'(4035,T2$(9,2))
17760 PRINT (OSGUI.CHAN)'TITLE'(4045,T3$(1,11)),'TITLE'(4050,T3$(12,11))
17765 PRINT (OSGUI.CHAN)'TITLE'(4060,T3$(23,2)),'TITLE'(4070,T3$(25,2))
17770 PRINT (OSGUI.CHAN)'TITLE'(4080,T2$(53,16))
17775 IF NUM(T2$(1,7))>0 THEN LET X=NUM(T2$(1,7)) ELSE LET X=-1
17780 PRINT (OSGUI.CHAN)'TITLE'(4090,FND$(X))
17782 PRINT (OSGUI.CHAN)'TITLE'(4095,T5$(164,12))
17785 PRINT (OSGUI.CHAN)'TITLE'(4100,T4$(21,49))
17790 PRINT (OSGUI.CHAN)'TITLE'(4110,T3$(62,50)+T7$(2,13)),'TITLE'(4115,T3$(132,63))
17795 PRINT (OSGUI.CHAN)'TITLE'(4120,T3$(112,20)),'TITLE'(4225,T7$(15,45))
17800 PRINT (OSGUI.CHAN)'TITLE'(4130,T4$(1,20))
17805 PRINT (OSGUI.CHAN)'TITLE'(4140,T4$(96,65))
17810 PRINT (OSGUI.CHAN)'TITLE'(4150,T4$(76,20))
17815 PRINT (OSGUI.CHAN)'TITLE'(4160,T5$(108,16))
17820 IF NUM(T5$(13,7))>0 THEN LET X=NUM(T5$(13,7)) ELSE LET X=-1
17825 PRINT (OSGUI.CHAN)'TITLE'(4170,FND$(X)),'TITLE'(4180,T5$(148,16))
17830 PRINT (OSGUI.CHAN)'TITLE'(4190,T5$(21,18)),'TITLE'(4200,T5$(39,8))
17835 IF NUM(T5$(47,7))>0 THEN LET X=NUM(T5$(47,7)) ELSE LET X=-1
17840 PRINT (OSGUI.CHAN)'TITLE'(4210,FND$(X))
17845 PRINT (OSGUI.CHAN)'TITLE'(4220,T5$(55,10))
17850 PRINT (OSGUI.CHAN)'TITLE'(4230,T5$(65,15))
17855 IF NUM(T5$(80,7))>0 THEN LET X=NUM(T5$(80,7)) ELSE LET X=-1
17860 PRINT (OSGUI.CHAN)'TITLE'(4240,FND$(X))
17865 PRINT (OSGUI.CHAN)'TITLE'(4250,T5$(88,20))
17870 PRINT (OSGUI.CHAN)'TITLE'(4260,T3$(27,35))
17875 PRINT (OSGUI.CHAN)'TITLE'(4270,T5$(124,10))
17877 PRINT (OSGUI.CHAN)'TITLE'(4275,T5$(11,2))
17880 PRINT (OSGUI.CHAN)'TITLE'(4280,FNGUINUM$(NUM(T6$(45,5)),M6$,4280))
17885 PRINT (OSGUI.CHAN)'TITLE'(4290,FNGUINUM$(NUM(T6$(50,5)),M6$,4280))
17890 RETURN 
17895 GUI_DATA1: 
17900 LET GUI_POS=4010
17902 IF W8$<>FILL(6) THEN READ (FILE[3],KEY=W8$,DOM=17910); GOTO 17910
17905 READ (FILE[3],KEY=T0$,DOM=17910)
17910 FOR I=1 TO MAXLINE
17915 READ (FILE[3],END=17955)IOL=IPTR2X
17920 IF D1$(1,6)<>T0$ THEN IF D1$(1,6)<>W8$ THEN GOTO 17955
17925 IF D4[2]>0 THEN LET X1$=STR(D4[2]:M2$) ELSE LET X1$=FILL(LEN(M2$))
17930 IF D4[3]>0 THEN LET X2$=STR(D4[3]:M5$) ELSE LET X2$=FILL(LEN(M5$))
17935 PRINT (OSGUI.CHAN)'TITLE'(GUI_POS,D2$),'TITLE'(GUI_POS+10,D3$)
17940 PRINT (OSGUI.CHAN)'TITLE'(GUI_POS+20,FNGUINUM$(D4[0],M4$,GUI_POS+20)),'TITLE'(GUI_POS+40,FNGUINUM$(D4[1],M3$,GUI_POS+40))
17945 PRINT (OSGUI.CHAN)'TITLE'(GUI_POS+50,FNGUINUM$(D4[2],M12$,GUI_POS+50)),'TITLE'(GUI_POS+60,FNGUINUM$(D4[3],M5$,GUI_POS+60))
17950 GOTO 17960
17955 EXITTO 17970
17960 LET GUI_POS=GUI_POS+70
17965 NEXT I
17972 GOSUB 3560
17973 GOSUB UPDATE_IPTR2X_COPYFROM
17975 PRINT (OSGUI.CHAN)'TITLE'(2000,T0$),'TITLE'(4915,T6$(1,12)),'TITLE'(4940,T6$(25,20))
17980 PRINT (OSGUI.CHAN)'TITLE'(4920,FNGUINUM$(NUM(T6$(13,6)),M8$,4920)),'TITLE'(4930,FNGUINUM$(NUM(T6$(19,6)),M9$,4930))
17985 PRINT (OSGUI.CHAN)'DISABLE'(4000)
17987 IF T2$(8,1)<>"Y" THEN PRINT (OSGUI.CHAN)'DISABLE'(4950,4960,14960)
17990 IF N0$<>"TRAN" THEN PRINT (OSGUI.CHAN)'DISABLE'(4915,4920,4930)
17995 RETURN 
17996 GUI_DATA2: 
17997 PRINT (OSGUI.CHAN)'TITLE'(4010,L2$(53,6))
17998 RETURN 
18000 REM 18000,5 "----- Disable Fields"
18005 DISABLE_FIELDS: 
18010 IF GUI=0 THEN GOTO 18045
18015 PRINT (OSGUI.CHAN)'ENABLE'(4000,14000)
18020 FOR I=4010 TO 4290 STEP 10
18025 PRINT (OSGUI.CHAN)'DISABLE'(I)
18030 NEXT I
18035 PRINT (OSGUI.CHAN)'DISABLE'(4015,4020,4025,4035,4045,4055,4115,4225,4275,14275,4095,4008,14008)
18040 PRINT (OSGUI.CHAN)'DISABLE'(14035,14080,14100,14110,14115,14120,14130,14140,14150,14190,14250,14260)
18045 RETURN 
18100 REM 18100,5 "----- Enable Fields"
18105 ENABLE_FIELDS: 
18110 IF GUI=0 THEN GOTO 18185
18115 PRINT (OSGUI.CHAN)'DISABLE'(4000,14000)
18120 FOR I=4010 TO 4290 STEP 10
18125 IF I=4040 AND T2$(9,2)<>"63" THEN GOTO 18150
18130 IF I=4050 AND VESSEL_FTZ$="Y" THEN GOTO 18150
18135 IF I=4020 THEN GOTO 18150
18140 IF (I=4280 OR I=4290) AND POS(T2$(9,2)="3335363739",2)=0 THEN GOTO 18150
18145 PRINT (OSGUI.CHAN)'ENABLE'(I)
18150 NEXT I
18155 IF VESSEL_FTZ$<>"Y" THEN PRINT (OSGUI.CHAN)'ENABLE'(4045,4050) ELSE PRINT (OSGUI.CHAN)'ENABLE'(4055)
18164 IF VESSEL_FTZ$="Y" AND T5$(20,1)="Y" AND CUST$=SP_CUST$ THEN PRINT (OSGUI.CHAN)'ENABLE'(4225)
18165 PRINT (OSGUI.CHAN)'ENABLE'(4035,4115,4095,4008,14008)
18170 IF T2$(9,2)="36" THEN PRINT (OSGUI.CHAN)'ENABLE'(4040)
18175 IF T2$(11,8)<>FILL(8) THEN PRINT (OSGUI.CHAN)'ENABLE'(4015,4020,4025)
18180 PRINT (OSGUI.CHAN)'ENABLE'(14035,14080,14100,14110,14115,14120,14130,14140,14150,14190,14250,14260,4275,14275)
18182 REM IF QP_OPT$="Y" THEN PRINT (OSGUI.CHAN)'ENABLE'(-20602)
18185 RETURN 
18200 REM 18200,5 "----- Clear GUI Global"
18205 CLEAR_GLOBAL: 
18210 IF GUI THEN LET DUMMY$=STBL("!CLEAR","DESTID",ERR=18215)
18215 RETURN 
18400 REM 18400,5 "----- Destroy GUI Window -----"
18405 DESTROY_GUI_WINDOW: 
18407 IF GUI=0 THEN GOTO 18415
18410 PRINT (OSGUI.CHAN)'HIDE'(0)
18412 PRINT (OSGUI.CHAN)'CONTEXT'(OSGUI.CUR_CONTEXT[SAVE_CONTEXT])
18413 LET OSGUI.CONTEXT_POINTER=SAVE_CONTEXT
18415 RETURN 
18420 ENABLE_MAXLINE: 
18422 FOR I=4710 TO 4910 STEP 10; PRINT (OSGUI.CHAN)'HIDE'(I); NEXT I
18425 IF MAXLINE=10 THEN GOTO 18447
18430 IF MAXLINE=11 THEN PRINT (OSGUI.CHAN)'SHOW'(4710,4720,4730,4740,4750,4760,4770); GOTO 18447
18435 FOR I=4710 TO 4910 STEP 10
18440 PRINT (OSGUI.CHAN)'SHOW'(I)
18445 NEXT I
18447 IF T2$(8,1)="Y" THEN PRINT (OSGUI.CHAN)'ENABLE'(4950,4960,14960)
18450 RETURN 
18900 REM 0
18910 DEF FNLIST(ID,PARAM$,LIST$,LEN)
18920 LET XX=POS(PARAM$=LIST$); IF XX=0 THEN PRINT (OSGUI.CHAN)'LISTUNSEL'(ID,0) ELSE LET XX=(XX-1)/LEN; PRINT (OSGUI.CHAN)'LISTSEL'(ID,XX)
18930 RETURN 1
18940 FNEND